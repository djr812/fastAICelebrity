2025-04-11 21:39:57,195 - INFO - ==================================================
2025-04-11 21:39:57,196 - INFO - Starting simplified celebrity recognition training
2025-04-11 21:39:57,196 - INFO - ==================================================
2025-04-11 21:39:57,196 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 21:39:57,196 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 21:39:57,196 - INFO - FastAI version: 2.7.19
2025-04-11 21:39:57,225 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 21:39:57,225 - INFO - CUDA version: 12.4
2025-04-11 21:39:57,225 - INFO - Loading identity data...
2025-04-11 21:39:57,367 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 21:39:59,635 - INFO - Filtered out 1 missing images
2025-04-11 21:39:59,669 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 21:39:59,705 - INFO - Limited to top 20 celebrities: 638 images
2025-04-11 21:39:59,706 - INFO - Min images per class: 30
2025-04-11 21:39:59,706 - INFO - Max images per class: 35
2025-04-11 21:39:59,706 - INFO - Avg images per class: 31.9
2025-04-11 21:39:59,733 - INFO - Saved 60 sample images to sample_images/
2025-04-11 21:39:59,733 - INFO - Data loading completed in 2.51s
2025-04-11 21:39:59,733 - INFO - Creating databunch...
2025-04-11 21:39:59,735 - INFO - Training set: 510 images
2025-04-11 21:39:59,735 - INFO - Validation set: 128 images
2025-04-11 21:40:00,085 - INFO - Created databunch in 0.35s
2025-04-11 21:40:00,085 - INFO - Checking dataloaders...
2025-04-11 21:40:00,158 - INFO - Successfully retrieved a batch of shape torch.Size([16, 3, 224, 224])
2025-04-11 21:40:00,158 - INFO - Labels shape: torch.Size([16])
2025-04-11 21:40:00,158 - INFO - Classes: 20 unique classes
2025-04-11 21:40:00,290 - INFO - Batch 0: torch.Size([16, 3, 224, 224]), torch.Size([16])
2025-04-11 21:40:00,318 - INFO - Batch 1: torch.Size([16, 3, 224, 224]), torch.Size([16])
2025-04-11 21:40:00,397 - INFO - Dataloader validation successful
2025-04-11 21:40:00,399 - INFO - DataLoaders creation completed in 3.17s
2025-04-11 21:40:00,399 - INFO - Starting model training...
2025-04-11 21:40:00,399 - INFO - GPU Memory: 8.13MB allocated, 84.00MB cached
2025-04-11 21:40:00,399 - INFO - Creating learner with resnet34 architecture...
2025-04-11 21:40:00,650 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet34.a1_in1k)
2025-04-11 21:40:19,049 - INFO - [timm/resnet34.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 21:40:19,098 - INFO - Mixed precision enabled
2025-04-11 21:40:19,099 - INFO - Starting training...
2025-04-11 21:40:19,259 - INFO - Batch 0/31 of epoch 0
2025-04-11 21:40:19,260 - INFO - GPU Memory: 102.96MB allocated, 148.00MB cached
2025-04-11 21:40:21,069 - INFO - Batch 10/31 of epoch 0
2025-04-11 21:40:21,070 - INFO - GPU Memory: 117.45MB allocated, 506.00MB cached
2025-04-11 21:40:22,671 - INFO - Batch 20/31 of epoch 0
2025-04-11 21:40:22,672 - INFO - GPU Memory: 117.45MB allocated, 506.00MB cached
2025-04-11 21:40:24,288 - INFO - Batch 30/31 of epoch 0
2025-04-11 21:40:24,289 - INFO - GPU Memory: 117.45MB allocated, 506.00MB cached
2025-04-11 21:40:24,595 - INFO - Batch 0/31 of epoch 0
2025-04-11 21:40:24,596 - INFO - GPU Memory: 117.45MB allocated, 506.00MB cached
2025-04-11 21:40:25,201 - INFO - Completed epoch 0
2025-04-11 21:40:25,201 - ERROR - Error during training: Exception occured in `DetailedProgressCallback` when calling event `after_epoch`:
	list index out of range
2025-04-11 21:40:25,201 - ERROR - Training failed: Exception occured in `DetailedProgressCallback` when calling event `after_epoch`:
	list index out of range
2025-04-11 21:40:25,203 - ERROR - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 279, in main
    learn = train_model(dls)
            ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/simpler_train.py", line 232, in train_model
    learn.fit(NUM_EPOCHS, 1e-3)
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 272, in fit
    self._with_events(self._do_fit, 'fit', CancelFitException, self._end_cleanup)
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 261, in _do_fit
    self._with_events(self._do_epoch, 'epoch', CancelEpochException)
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 209, in _with_events
    self(f'after_{event_type}');  final()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 180, in __call__
    def __call__(self, event_name): L(event_name).map(self._call_one)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastcore/foundation.py", line 163, in map
    def map(self, f, *args, **kwargs): return self._new(map_ex(self, f, *args, gen=False, **kwargs))
                                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastcore/basics.py", line 934, in map_ex
    return list(res)
           ^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastcore/basics.py", line 919, in __call__
    return self.func(*fargs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/learner.py", line 184, in _call_one
    for cb in self.cbs.sorted('order'): cb(event_name)
                                        ^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/callback/core.py", line 64, in __call__
    except Exception as e: raise modify_exception(e, f'Exception occured in `{self.__class__.__name__}` when calling event `{event_name}`:\n\t{e.args[0]}', replace=True)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/fastai/callback/core.py", line 62, in __call__
    try: res = getcallable(self, event_name)()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/simpler_train.py", line 222, in after_epoch
    metrics = self.learn.recorder.values[-1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
IndexError: Exception occured in `DetailedProgressCallback` when calling event `after_epoch`:
	list index out of range

2025-04-11 21:40:25,203 - INFO - ==================================================
2025-04-11 21:40:25,204 - INFO - Training failed - see log for details
2025-04-11 21:40:25,204 - INFO - ==================================================
2025-04-11 21:43:23,190 - INFO - ==================================================
2025-04-11 21:43:23,191 - INFO - Starting simplified celebrity recognition training
2025-04-11 21:43:23,191 - INFO - ==================================================
2025-04-11 21:43:23,191 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 21:43:23,191 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 21:43:23,191 - INFO - FastAI version: 2.7.19
2025-04-11 21:43:23,220 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 21:43:23,220 - INFO - CUDA version: 12.4
2025-04-11 21:43:23,221 - INFO - Loading identity data...
2025-04-11 21:43:23,362 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 21:43:25,614 - INFO - Filtered out 1 missing images
2025-04-11 21:43:25,649 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 21:43:25,686 - INFO - Limited to top 10 celebrities: 331 images
2025-04-11 21:43:25,686 - INFO - Min images per class: 31
2025-04-11 21:43:25,686 - INFO - Max images per class: 35
2025-04-11 21:43:25,686 - INFO - Avg images per class: 33.1
2025-04-11 21:43:25,697 - INFO - Saved 30 sample images to sample_images/
2025-04-11 21:43:25,697 - INFO - Data loading completed in 2.48s
2025-04-11 21:43:25,697 - INFO - Creating databunch...
2025-04-11 21:43:25,699 - INFO - Training set: 264 images
2025-04-11 21:43:25,699 - INFO - Validation set: 67 images
2025-04-11 21:43:25,945 - INFO - Created databunch in 0.25s
2025-04-11 21:43:25,945 - INFO - Checking dataloaders...
2025-04-11 21:43:25,962 - INFO - Successfully retrieved a batch of shape torch.Size([8, 3, 160, 160])
2025-04-11 21:43:25,962 - INFO - Labels shape: torch.Size([8])
2025-04-11 21:43:25,963 - INFO - Classes: 10 unique classes
2025-04-11 21:43:25,978 - INFO - Batch 0: torch.Size([8, 3, 160, 160]), torch.Size([8])
2025-04-11 21:43:25,994 - INFO - Batch 1: torch.Size([8, 3, 160, 160]), torch.Size([8])
2025-04-11 21:43:26,009 - INFO - Dataloader validation successful
2025-04-11 21:43:26,009 - INFO - DataLoaders creation completed in 2.79s
2025-04-11 21:43:26,010 - INFO - Starting model training...
2025-04-11 21:43:26,010 - INFO - GPU Memory: 0.00MB allocated, 22.00MB cached
2025-04-11 21:43:26,010 - INFO - Creating learner with resnet18 architecture...
2025-04-11 21:43:26,138 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 21:43:36,754 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 21:43:36,775 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 21:43:36,776 - INFO - Starting basic training with simple fit...
2025-04-11 21:43:36,804 - INFO - Processing batch 0 of epoch 0
2025-04-11 21:43:36,804 - INFO - GPU Memory: 48.26MB allocated, 66.00MB cached
2025-04-11 21:43:36,804 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,056 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,109 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,162 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,213 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,264 - INFO - Processing batch 5 of epoch 0
2025-04-11 21:43:37,264 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:37,264 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,316 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,365 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,414 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,463 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,511 - INFO - Processing batch 10 of epoch 0
2025-04-11 21:43:37,511 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:37,511 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,559 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,606 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,654 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,701 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,748 - INFO - Processing batch 15 of epoch 0
2025-04-11 21:43:37,749 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:37,749 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,796 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,843 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,890 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,937 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:37,984 - INFO - Processing batch 20 of epoch 0
2025-04-11 21:43:37,985 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:37,985 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,032 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,080 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,161 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,208 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,256 - INFO - Processing batch 25 of epoch 0
2025-04-11 21:43:38,256 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:38,256 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,303 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,351 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,398 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,445 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,493 - INFO - Processing batch 30 of epoch 0
2025-04-11 21:43:38,493 - INFO - GPU Memory: 71.41MB allocated, 218.00MB cached
2025-04-11 21:43:38,493 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,540 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,587 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,636 - INFO - Processing batch 0 of epoch 0
2025-04-11 21:43:38,636 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:38,636 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,670 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,699 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,728 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,757 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,786 - INFO - Processing batch 5 of epoch 0
2025-04-11 21:43:38,787 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:38,787 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,815 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,844 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,864 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,878 - INFO - Completed epoch 0
2025-04-11 21:43:38,879 - INFO - No metrics recorded for this epoch
2025-04-11 21:43:38,879 - INFO - GPU Memory: 68.76MB allocated, 218.00MB cached
2025-04-11 21:43:38,896 - INFO - Processing batch 0 of epoch 1
2025-04-11 21:43:38,896 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:38,896 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,944 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:38,991 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,038 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,086 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,133 - INFO - Processing batch 5 of epoch 1
2025-04-11 21:43:39,133 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:39,133 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,180 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,227 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,275 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,322 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,369 - INFO - Processing batch 10 of epoch 1
2025-04-11 21:43:39,370 - INFO - GPU Memory: 71.41MB allocated, 218.00MB cached
2025-04-11 21:43:39,370 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,417 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,464 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,512 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,559 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,606 - INFO - Processing batch 15 of epoch 1
2025-04-11 21:43:39,606 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:39,606 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,653 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,701 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,748 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,795 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,842 - INFO - Processing batch 20 of epoch 1
2025-04-11 21:43:39,843 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:39,843 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,890 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,938 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:39,985 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,032 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,080 - INFO - Processing batch 25 of epoch 1
2025-04-11 21:43:40,080 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:40,080 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,127 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,175 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,222 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,270 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,317 - INFO - Processing batch 30 of epoch 1
2025-04-11 21:43:40,317 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:40,317 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,364 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,413 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,461 - INFO - Processing batch 0 of epoch 1
2025-04-11 21:43:40,461 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:40,461 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,490 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,519 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,549 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,578 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,607 - INFO - Processing batch 5 of epoch 1
2025-04-11 21:43:40,607 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:40,607 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,637 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,665 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,686 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,694 - INFO - Completed epoch 1
2025-04-11 21:43:40,694 - INFO - Metrics: epoch: 3.7000, train_loss: 2.6103, valid_loss: 0.1194
2025-04-11 21:43:40,694 - INFO - GPU Memory: 68.76MB allocated, 218.00MB cached
2025-04-11 21:43:40,710 - INFO - Processing batch 0 of epoch 2
2025-04-11 21:43:40,711 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:40,711 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,758 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,805 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,853 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,901 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,948 - INFO - Processing batch 5 of epoch 2
2025-04-11 21:43:40,949 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:40,949 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:40,996 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,043 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,090 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,138 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,185 - INFO - Processing batch 10 of epoch 2
2025-04-11 21:43:41,186 - INFO - GPU Memory: 71.41MB allocated, 218.00MB cached
2025-04-11 21:43:41,186 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,233 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,280 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,328 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,375 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,422 - INFO - Processing batch 15 of epoch 2
2025-04-11 21:43:41,423 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:41,423 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,470 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,517 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,565 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,612 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,659 - INFO - Processing batch 20 of epoch 2
2025-04-11 21:43:41,659 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:41,659 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,707 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,755 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,803 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,850 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,897 - INFO - Processing batch 25 of epoch 2
2025-04-11 21:43:41,897 - INFO - GPU Memory: 73.16MB allocated, 218.00MB cached
2025-04-11 21:43:41,898 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,945 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:41,992 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,039 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,087 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,134 - INFO - Processing batch 30 of epoch 2
2025-04-11 21:43:42,134 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:42,135 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,182 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,229 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,277 - INFO - Processing batch 0 of epoch 2
2025-04-11 21:43:42,278 - INFO - GPU Memory: 70.81MB allocated, 218.00MB cached
2025-04-11 21:43:42,278 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,306 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,335 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,363 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,392 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,420 - INFO - Processing batch 5 of epoch 2
2025-04-11 21:43:42,421 - INFO - GPU Memory: 73.75MB allocated, 218.00MB cached
2025-04-11 21:43:42,421 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,449 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,478 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,499 - INFO - Error accessing batch data: 'tuple' object has no attribute 'shape'
2025-04-11 21:43:42,507 - INFO - Completed epoch 2
2025-04-11 21:43:42,507 - INFO - Metrics: epoch: 3.5192, train_loss: 2.3595, valid_loss: 0.1940
2025-04-11 21:43:42,507 - INFO - GPU Memory: 68.76MB allocated, 218.00MB cached
2025-04-11 21:43:42,569 - INFO - Model saved to simple_model.pth
2025-04-11 21:43:42,569 - INFO - Training process completed in 16.56s
2025-04-11 21:43:42,569 - INFO - Total processing time: 19.35s
2025-04-11 21:43:42,569 - INFO - ==================================================
2025-04-11 21:43:42,569 - INFO - Training completed successfully
2025-04-11 21:43:42,569 - INFO - ==================================================
2025-04-11 21:46:16,442 - INFO - ==================================================
2025-04-11 21:46:16,442 - INFO - Starting simplified celebrity recognition training
2025-04-11 21:46:16,443 - INFO - ==================================================
2025-04-11 21:46:16,443 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 21:46:16,443 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 21:46:16,443 - INFO - FastAI version: 2.7.19
2025-04-11 21:46:16,472 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 21:46:16,472 - INFO - CUDA version: 12.4
2025-04-11 21:46:16,472 - INFO - Loading identity data...
2025-04-11 21:46:16,613 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 21:46:18,914 - INFO - Filtered out 1 missing images
2025-04-11 21:46:18,949 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 21:46:18,984 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 21:46:18,985 - INFO - Min images per class: 34
2025-04-11 21:46:18,985 - INFO - Max images per class: 35
2025-04-11 21:46:18,985 - INFO - Avg images per class: 34.6
2025-04-11 21:46:18,991 - INFO - Saved 15 sample images to sample_images/
2025-04-11 21:46:18,991 - INFO - Data loading completed in 2.52s
2025-04-11 21:46:18,991 - INFO - Creating databunch...
2025-04-11 21:46:18,993 - INFO - Training set: 138 images
2025-04-11 21:46:18,993 - INFO - Validation set: 35 images
2025-04-11 21:46:19,212 - INFO - Created databunch in 0.22s
2025-04-11 21:46:19,212 - INFO - Checking dataloaders...
2025-04-11 21:46:19,221 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 21:46:19,222 - INFO - Labels shape: torch.Size([4])
2025-04-11 21:46:19,222 - INFO - Classes: 5 unique classes
2025-04-11 21:46:19,230 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4])
2025-04-11 21:46:19,238 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4])
2025-04-11 21:46:19,246 - INFO - Dataloader validation successful
2025-04-11 21:46:19,247 - INFO - DataLoaders creation completed in 2.77s
2025-04-11 21:46:19,247 - INFO - Starting model training...
2025-04-11 21:46:19,248 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 21:46:19,248 - INFO - Creating learner with resnet18 architecture...
2025-04-11 21:46:19,248 - ERROR - Error during training: cannot access local variable 'accuracy' where it is not associated with a value
2025-04-11 21:46:19,248 - ERROR - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 201, in train_model
    metrics=[accuracy],
             ^^^^^^^^
UnboundLocalError: cannot access local variable 'accuracy' where it is not associated with a value

2025-04-11 21:46:19,249 - ERROR - Training failed: cannot access local variable 'accuracy' where it is not associated with a value
2025-04-11 21:46:19,249 - ERROR - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 419, in main
    learn = train_model(dls)
            ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/simpler_train.py", line 201, in train_model
    metrics=[accuracy],
             ^^^^^^^^
UnboundLocalError: cannot access local variable 'accuracy' where it is not associated with a value

2025-04-11 21:46:19,249 - INFO - ==================================================
2025-04-11 21:46:19,250 - INFO - Training failed - see log for details
2025-04-11 21:46:19,250 - INFO - ==================================================
2025-04-11 21:47:45,461 - INFO - ==================================================
2025-04-11 21:47:45,461 - INFO - Starting simplified celebrity recognition training
2025-04-11 21:47:45,461 - INFO - ==================================================
2025-04-11 21:47:45,461 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 21:47:45,461 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 21:47:45,461 - INFO - FastAI version: 2.7.19
2025-04-11 21:47:45,490 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 21:47:45,490 - INFO - CUDA version: 12.4
2025-04-11 21:47:45,490 - INFO - Loading identity data...
2025-04-11 21:47:45,631 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 21:47:47,918 - INFO - Filtered out 1 missing images
2025-04-11 21:47:47,952 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 21:47:47,987 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 21:47:47,988 - INFO - Min images per class: 34
2025-04-11 21:47:47,988 - INFO - Max images per class: 35
2025-04-11 21:47:47,988 - INFO - Avg images per class: 34.6
2025-04-11 21:47:47,994 - INFO - Saved 15 sample images to sample_images/
2025-04-11 21:47:47,994 - INFO - Data loading completed in 2.50s
2025-04-11 21:47:47,994 - INFO - Creating databunch...
2025-04-11 21:47:47,996 - INFO - Training set: 138 images
2025-04-11 21:47:47,996 - INFO - Validation set: 35 images
2025-04-11 21:47:48,226 - INFO - Created databunch in 0.23s
2025-04-11 21:47:48,226 - INFO - Checking dataloaders...
2025-04-11 21:47:48,236 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 21:47:48,236 - INFO - Labels shape: torch.Size([4])
2025-04-11 21:47:48,236 - INFO - Classes: 5 unique classes
2025-04-11 21:47:48,245 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4])
2025-04-11 21:47:48,253 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4])
2025-04-11 21:47:48,261 - INFO - Dataloader validation successful
2025-04-11 21:47:48,262 - INFO - DataLoaders creation completed in 2.77s
2025-04-11 21:47:48,262 - INFO - Starting model training...
2025-04-11 21:47:48,263 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 21:47:48,263 - INFO - Creating learner with resnet18 architecture...
2025-04-11 21:47:48,391 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 21:47:48,785 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 21:47:48,820 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 21:47:48,820 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 21:47:48,820 - INFO - Starting epoch 1/2
2025-04-11 21:47:48,830 - INFO - Training batch 0
2025-04-11 21:47:48,830 - INFO - Error processing batch 0: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,839 - INFO - Error processing batch 1: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,848 - INFO - Error processing batch 2: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,856 - INFO - Error processing batch 3: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,865 - INFO - Error processing batch 4: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,873 - INFO - Training batch 5
2025-04-11 21:47:48,874 - INFO - Error processing batch 5: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,882 - INFO - Error processing batch 6: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,891 - INFO - Error processing batch 7: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,899 - INFO - Error processing batch 8: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,908 - INFO - Error processing batch 9: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,916 - INFO - Training batch 10
2025-04-11 21:47:48,917 - INFO - Error processing batch 10: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,925 - INFO - Error processing batch 11: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,934 - INFO - Error processing batch 12: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,942 - INFO - Error processing batch 13: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,951 - INFO - Error processing batch 14: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,959 - INFO - Training batch 15
2025-04-11 21:47:48,960 - INFO - Error processing batch 15: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,968 - INFO - Error processing batch 16: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,977 - INFO - Error processing batch 17: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,985 - INFO - Error processing batch 18: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:48,994 - INFO - Error processing batch 19: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,002 - INFO - Training batch 20
2025-04-11 21:47:49,003 - INFO - Error processing batch 20: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,014 - INFO - Error processing batch 21: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,023 - INFO - Error processing batch 22: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,032 - INFO - Error processing batch 23: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,041 - INFO - Error processing batch 24: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,049 - INFO - Training batch 25
2025-04-11 21:47:49,050 - INFO - Error processing batch 25: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,058 - INFO - Error processing batch 26: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,067 - INFO - Error processing batch 27: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,076 - INFO - Error processing batch 28: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,084 - INFO - Error processing batch 29: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,093 - INFO - Training batch 30
2025-04-11 21:47:49,093 - INFO - Error processing batch 30: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,102 - INFO - Error processing batch 31: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,111 - INFO - Error processing batch 32: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,119 - INFO - Error processing batch 33: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,123 - INFO - Running validation...
2025-04-11 21:47:49,132 - INFO - Error in validation batch 0: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,141 - INFO - Error in validation batch 1: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,149 - INFO - Error in validation batch 2: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,158 - INFO - Error in validation batch 3: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,167 - INFO - Error in validation batch 4: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,175 - INFO - Error in validation batch 5: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,184 - INFO - Error in validation batch 6: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,192 - INFO - Error in validation batch 7: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,199 - INFO - Error in validation batch 8: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,199 - INFO - No valid validation results available
2025-04-11 21:47:49,240 - INFO - Saved model for epoch 1
2025-04-11 21:47:49,240 - INFO - Starting epoch 2/2
2025-04-11 21:47:49,248 - INFO - Training batch 0
2025-04-11 21:47:49,249 - INFO - Error processing batch 0: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,257 - INFO - Error processing batch 1: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,265 - INFO - Error processing batch 2: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,274 - INFO - Error processing batch 3: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,283 - INFO - Error processing batch 4: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,291 - INFO - Training batch 5
2025-04-11 21:47:49,292 - INFO - Error processing batch 5: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,301 - INFO - Error processing batch 6: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,310 - INFO - Error processing batch 7: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,318 - INFO - Error processing batch 8: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,327 - INFO - Error processing batch 9: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,335 - INFO - Training batch 10
2025-04-11 21:47:49,336 - INFO - Error processing batch 10: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,344 - INFO - Error processing batch 11: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,353 - INFO - Error processing batch 12: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,361 - INFO - Error processing batch 13: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,370 - INFO - Error processing batch 14: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,378 - INFO - Training batch 15
2025-04-11 21:47:49,379 - INFO - Error processing batch 15: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,388 - INFO - Error processing batch 16: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,396 - INFO - Error processing batch 17: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,405 - INFO - Error processing batch 18: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,414 - INFO - Error processing batch 19: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,422 - INFO - Training batch 20
2025-04-11 21:47:49,423 - INFO - Error processing batch 20: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,431 - INFO - Error processing batch 21: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,440 - INFO - Error processing batch 22: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,449 - INFO - Error processing batch 23: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,458 - INFO - Error processing batch 24: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,466 - INFO - Training batch 25
2025-04-11 21:47:49,467 - INFO - Error processing batch 25: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,476 - INFO - Error processing batch 26: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,485 - INFO - Error processing batch 27: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,494 - INFO - Error processing batch 28: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,503 - INFO - Error processing batch 29: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,512 - INFO - Training batch 30
2025-04-11 21:47:49,513 - INFO - Error processing batch 30: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,521 - INFO - Error processing batch 31: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,530 - INFO - Error processing batch 32: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,538 - INFO - Error processing batch 33: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,542 - INFO - Running validation...
2025-04-11 21:47:49,551 - INFO - Error in validation batch 0: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,559 - INFO - Error in validation batch 1: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,568 - INFO - Error in validation batch 2: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,578 - INFO - Error in validation batch 3: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,586 - INFO - Error in validation batch 4: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,595 - INFO - Error in validation batch 5: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,603 - INFO - Error in validation batch 6: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,613 - INFO - Error in validation batch 7: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,620 - INFO - Error in validation batch 8: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
2025-04-11 21:47:49,620 - INFO - No valid validation results available
2025-04-11 21:47:49,660 - INFO - Saved model for epoch 2
2025-04-11 21:47:49,660 - INFO - Simplified training completed
2025-04-11 21:47:49,869 - INFO - Model saved to simple_model.pth
2025-04-11 21:47:49,869 - INFO - Training process completed in 1.61s
2025-04-11 21:47:49,869 - INFO - Total processing time: 4.38s
2025-04-11 21:47:49,870 - INFO - ==================================================
2025-04-11 21:47:49,870 - INFO - Training completed successfully
2025-04-11 21:47:49,870 - INFO - ==================================================
2025-04-11 21:51:34,169 - INFO - ==================================================
2025-04-11 21:51:34,169 - INFO - Starting simplified celebrity recognition training
2025-04-11 21:51:34,169 - INFO - ==================================================
2025-04-11 21:51:34,169 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 21:51:34,169 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 21:51:34,169 - INFO - FastAI version: 2.7.19
2025-04-11 21:51:34,186 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 21:51:34,186 - INFO - CUDA version: 12.4
2025-04-11 21:51:34,186 - INFO - Using device: cuda
2025-04-11 21:51:34,186 - INFO - Loading identity data...
2025-04-11 21:51:34,327 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 21:51:36,603 - INFO - Filtered out 1 missing images
2025-04-11 21:51:36,637 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 21:51:36,673 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 21:51:36,674 - INFO - Min images per class: 34
2025-04-11 21:51:36,674 - INFO - Max images per class: 35
2025-04-11 21:51:36,674 - INFO - Avg images per class: 34.6
2025-04-11 21:51:36,679 - INFO - Saved 15 sample images to sample_images/
2025-04-11 21:51:36,680 - INFO - Data loading completed in 2.49s
2025-04-11 21:51:36,680 - INFO - Creating databunch...
2025-04-11 21:51:36,681 - INFO - Training set: 138 images
2025-04-11 21:51:36,681 - INFO - Validation set: 35 images
2025-04-11 21:51:36,900 - INFO - Created databunch in 0.22s
2025-04-11 21:51:36,900 - INFO - Checking dataloaders...
2025-04-11 21:51:36,909 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 21:51:36,909 - INFO - Labels shape: torch.Size([4])
2025-04-11 21:51:36,910 - INFO - Classes: 5 unique classes
2025-04-11 21:51:36,910 - INFO - Data device: cuda:0
2025-04-11 21:51:36,919 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 21:51:36,929 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 21:51:36,938 - INFO - Dataloader validation successful
2025-04-11 21:51:36,939 - INFO - DataLoaders creation completed in 2.75s
2025-04-11 21:51:36,939 - INFO - Starting model training...
2025-04-11 21:51:36,939 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 21:51:36,939 - INFO - Creating learner with resnet18 architecture...
2025-04-11 21:51:37,068 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 21:51:37,813 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 21:51:37,837 - INFO - Moving model to device: cuda
2025-04-11 21:51:37,849 - INFO - Model is on device: cuda:0
2025-04-11 21:51:37,849 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 21:51:37,849 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 21:51:37,849 - INFO - Starting epoch 1/2
2025-04-11 21:51:37,858 - INFO - Training batch 0
2025-04-11 21:51:38,022 - INFO - Error processing batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,028 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,052 - INFO - Error processing batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,053 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,067 - INFO - Error processing batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,068 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,082 - INFO - Error processing batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,082 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,097 - INFO - Error processing batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,097 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,106 - INFO - Training batch 5
2025-04-11 21:51:38,112 - INFO - Error processing batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,113 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,127 - INFO - Error processing batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,127 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,142 - INFO - Error processing batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,143 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,157 - INFO - Error processing batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,158 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,174 - INFO - Error processing batch 9: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,175 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,183 - INFO - Training batch 10
2025-04-11 21:51:38,190 - INFO - Error processing batch 10: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,191 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,207 - INFO - Error processing batch 11: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,208 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,224 - INFO - Error processing batch 12: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,224 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,240 - INFO - Error processing batch 13: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,240 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,257 - INFO - Error processing batch 14: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,257 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,266 - INFO - Training batch 15
2025-04-11 21:51:38,273 - INFO - Error processing batch 15: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,274 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,289 - INFO - Error processing batch 16: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,290 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,306 - INFO - Error processing batch 17: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,307 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,322 - INFO - Error processing batch 18: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,323 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,338 - INFO - Error processing batch 19: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,338 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,347 - INFO - Training batch 20
2025-04-11 21:51:38,354 - INFO - Error processing batch 20: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,355 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,371 - INFO - Error processing batch 21: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,371 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,387 - INFO - Error processing batch 22: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,388 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,403 - INFO - Error processing batch 23: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,404 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,419 - INFO - Error processing batch 24: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,419 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,429 - INFO - Training batch 25
2025-04-11 21:51:38,436 - INFO - Error processing batch 25: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,437 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,453 - INFO - Error processing batch 26: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,453 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,469 - INFO - Error processing batch 27: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,470 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,486 - INFO - Error processing batch 28: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,486 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,502 - INFO - Error processing batch 29: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,503 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,512 - INFO - Training batch 30
2025-04-11 21:51:38,518 - INFO - Error processing batch 30: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,519 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,535 - INFO - Error processing batch 31: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,535 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,551 - INFO - Error processing batch 32: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,551 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,567 - INFO - Error processing batch 33: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,567 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,573 - INFO - Running validation...
2025-04-11 21:51:38,589 - INFO - Error in validation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,589 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,604 - INFO - Error in validation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,605 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,619 - INFO - Error in validation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,620 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,634 - INFO - Error in validation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,635 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,649 - INFO - Error in validation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,649 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,664 - INFO - Error in validation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,665 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,678 - INFO - Error in validation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,679 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,693 - INFO - Error in validation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,694 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,714 - INFO - Error in validation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:38,715 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:38,716 - INFO - No valid validation results available
2025-04-11 21:51:38,961 - INFO - Saved model for epoch 1
2025-04-11 21:51:38,962 - INFO - Starting epoch 2/2
2025-04-11 21:51:38,989 - INFO - Training batch 0
2025-04-11 21:51:39,008 - INFO - Error processing batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,010 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,052 - INFO - Error processing batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,053 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,087 - INFO - Error processing batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,088 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,107 - INFO - Error processing batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,108 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,123 - INFO - Error processing batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,123 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,131 - INFO - Training batch 5
2025-04-11 21:51:39,138 - INFO - Error processing batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,138 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,152 - INFO - Error processing batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,153 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,167 - INFO - Error processing batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,167 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,182 - INFO - Error processing batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,182 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,198 - INFO - Error processing batch 9: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,199 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,208 - INFO - Training batch 10
2025-04-11 21:51:39,214 - INFO - Error processing batch 10: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,215 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,230 - INFO - Error processing batch 11: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,231 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,246 - INFO - Error processing batch 12: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,246 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,261 - INFO - Error processing batch 13: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,262 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,277 - INFO - Error processing batch 14: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,277 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,287 - INFO - Training batch 15
2025-04-11 21:51:39,293 - INFO - Error processing batch 15: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,294 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,310 - INFO - Error processing batch 16: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,310 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,325 - INFO - Error processing batch 17: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,326 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,342 - INFO - Error processing batch 18: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,342 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,357 - INFO - Error processing batch 19: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,358 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,368 - INFO - Training batch 20
2025-04-11 21:51:39,374 - INFO - Error processing batch 20: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,375 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,390 - INFO - Error processing batch 21: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,391 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,406 - INFO - Error processing batch 22: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,407 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,422 - INFO - Error processing batch 23: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,423 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,439 - INFO - Error processing batch 24: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,439 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,447 - INFO - Training batch 25
2025-04-11 21:51:39,453 - INFO - Error processing batch 25: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,454 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,468 - INFO - Error processing batch 26: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,469 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,483 - INFO - Error processing batch 27: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,484 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,499 - INFO - Error processing batch 28: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,500 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,514 - INFO - Error processing batch 29: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,515 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,523 - INFO - Training batch 30
2025-04-11 21:51:39,529 - INFO - Error processing batch 30: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,530 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,544 - INFO - Error processing batch 31: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,545 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,559 - INFO - Error processing batch 32: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,560 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,574 - INFO - Error processing batch 33: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,574 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 251, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,578 - INFO - Running validation...
2025-04-11 21:51:39,591 - INFO - Error in validation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,592 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,605 - INFO - Error in validation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,605 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,618 - INFO - Error in validation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,618 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,631 - INFO - Error in validation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,632 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,644 - INFO - Error in validation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,645 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,660 - INFO - Error in validation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,661 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,673 - INFO - Error in validation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,674 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,687 - INFO - Error in validation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,687 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,699 - INFO - Error in validation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 21:51:39,699 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 282, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 21:51:39,699 - INFO - No valid validation results available
2025-04-11 21:51:39,955 - INFO - Saved model for epoch 2
2025-04-11 21:51:39,956 - INFO - Simplified training completed
2025-04-11 21:51:40,250 - INFO - Model saved to simple_model.pth
2025-04-11 21:51:40,250 - INFO - Training process completed in 3.31s
2025-04-11 21:51:40,251 - INFO - Total processing time: 6.06s
2025-04-11 21:51:40,251 - INFO - ==================================================
2025-04-11 21:51:40,251 - INFO - Training completed successfully
2025-04-11 21:51:40,251 - INFO - ==================================================
2025-04-11 22:01:31,938 - INFO - ==================================================
2025-04-11 22:01:31,939 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:01:31,939 - INFO - ==================================================
2025-04-11 22:01:31,939 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:01:31,939 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:01:31,939 - INFO - FastAI version: 2.7.19
2025-04-11 22:01:31,956 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:01:31,956 - INFO - CUDA version: 12.4
2025-04-11 22:01:31,956 - INFO - Using device: cuda
2025-04-11 22:01:31,956 - INFO - Loading identity data...
2025-04-11 22:01:32,097 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:01:34,360 - INFO - Filtered out 1 missing images
2025-04-11 22:01:34,395 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:01:34,429 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:01:34,430 - INFO - Min images per class: 34
2025-04-11 22:01:34,430 - INFO - Max images per class: 35
2025-04-11 22:01:34,430 - INFO - Avg images per class: 34.6
2025-04-11 22:01:34,436 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:01:34,436 - INFO - Data loading completed in 2.48s
2025-04-11 22:01:34,436 - INFO - Creating databunch...
2025-04-11 22:01:34,438 - INFO - Training set: 138 images
2025-04-11 22:01:34,438 - INFO - Validation set: 35 images
2025-04-11 22:01:34,666 - INFO - Created databunch in 0.23s
2025-04-11 22:01:34,666 - INFO - Checking dataloaders...
2025-04-11 22:01:34,675 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:01:34,675 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:01:34,675 - INFO - Classes: 5 unique classes
2025-04-11 22:01:34,676 - INFO - Data device: cuda:0
2025-04-11 22:01:34,684 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:01:34,693 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:01:34,701 - INFO - Dataloader validation successful
2025-04-11 22:01:34,701 - INFO - DataLoaders creation completed in 2.75s
2025-04-11 22:01:34,702 - INFO - Starting model training...
2025-04-11 22:01:34,702 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:01:34,702 - INFO - Creating learner with resnet18 architecture...
2025-04-11 22:01:34,832 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 22:01:35,217 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 22:01:35,249 - INFO - Moving model to device: cuda
2025-04-11 22:01:35,261 - INFO - Model is on device: cuda:0
2025-04-11 22:01:35,261 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 22:01:35,261 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 22:01:35,261 - INFO - Starting epoch 1/2
2025-04-11 22:01:35,270 - INFO - Training batch 0
2025-04-11 22:01:35,437 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,437 - INFO - Error processing batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,438 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,454 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,455 - INFO - Error processing batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,455 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,470 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,470 - INFO - Error processing batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,470 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,485 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,486 - INFO - Error processing batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,486 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,501 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,501 - INFO - Error processing batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,501 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,510 - INFO - Training batch 5
2025-04-11 22:01:35,516 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,516 - INFO - Error processing batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,517 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,531 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,531 - INFO - Error processing batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,532 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,547 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,547 - INFO - Error processing batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,547 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,562 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,562 - INFO - Error processing batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,562 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,577 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,577 - INFO - Error processing batch 9: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,578 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,586 - INFO - Training batch 10
2025-04-11 22:01:35,592 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,592 - INFO - Error processing batch 10: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,593 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,607 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,608 - INFO - Error processing batch 11: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,608 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,623 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,623 - INFO - Error processing batch 12: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,624 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,638 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,638 - INFO - Error processing batch 13: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,639 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,654 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,654 - INFO - Error processing batch 14: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,654 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,662 - INFO - Training batch 15
2025-04-11 22:01:35,669 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,669 - INFO - Error processing batch 15: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,670 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,684 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,685 - INFO - Error processing batch 16: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,685 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,699 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,700 - INFO - Error processing batch 17: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,700 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,715 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,715 - INFO - Error processing batch 18: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,715 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,730 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,730 - INFO - Error processing batch 19: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,731 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,739 - INFO - Training batch 20
2025-04-11 22:01:35,746 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,747 - INFO - Error processing batch 20: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,747 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,763 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,763 - INFO - Error processing batch 21: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,764 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,781 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,781 - INFO - Error processing batch 22: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,782 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,797 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,798 - INFO - Error processing batch 23: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,798 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,814 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,815 - INFO - Error processing batch 24: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,815 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,825 - INFO - Training batch 25
2025-04-11 22:01:35,832 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,832 - INFO - Error processing batch 25: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,833 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,848 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,849 - INFO - Error processing batch 26: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,849 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,865 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,865 - INFO - Error processing batch 27: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,866 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,881 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,882 - INFO - Error processing batch 28: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,882 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,898 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,899 - INFO - Error processing batch 29: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,899 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,908 - INFO - Training batch 30
2025-04-11 22:01:35,915 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,915 - INFO - Error processing batch 30: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,916 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,932 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,933 - INFO - Error processing batch 31: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,933 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,949 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,950 - INFO - Error processing batch 32: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,950 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,968 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:35,968 - INFO - Error processing batch 33: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,969 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:35,973 - INFO - Running validation...
2025-04-11 22:01:35,988 - INFO - Error in validation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:35,989 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,004 - INFO - Error in validation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,005 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,019 - INFO - Error in validation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,020 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,035 - INFO - Error in validation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,036 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,050 - INFO - Error in validation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,051 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,064 - INFO - Error in validation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,065 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,080 - INFO - Error in validation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,080 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,093 - INFO - Error in validation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,094 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,113 - INFO - Error in validation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,113 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,114 - INFO - No valid validation results available
2025-04-11 22:01:36,360 - INFO - Saved model for epoch 1
2025-04-11 22:01:36,360 - INFO - Starting epoch 2/2
2025-04-11 22:01:36,390 - INFO - Training batch 0
2025-04-11 22:01:36,412 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,413 - INFO - Error processing batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,414 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,463 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,463 - INFO - Error processing batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,464 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,491 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,492 - INFO - Error processing batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,492 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,510 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,510 - INFO - Error processing batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,510 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,525 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,525 - INFO - Error processing batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,526 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,534 - INFO - Training batch 5
2025-04-11 22:01:36,541 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,541 - INFO - Error processing batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,541 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,556 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,556 - INFO - Error processing batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,556 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,571 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,571 - INFO - Error processing batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,572 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,587 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,587 - INFO - Error processing batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,587 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,602 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,602 - INFO - Error processing batch 9: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,603 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,611 - INFO - Training batch 10
2025-04-11 22:01:36,618 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,618 - INFO - Error processing batch 10: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,619 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,634 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,634 - INFO - Error processing batch 11: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,635 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,651 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,651 - INFO - Error processing batch 12: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,652 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,667 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,668 - INFO - Error processing batch 13: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,668 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,685 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,685 - INFO - Error processing batch 14: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,686 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,695 - INFO - Training batch 15
2025-04-11 22:01:36,702 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,702 - INFO - Error processing batch 15: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,703 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,718 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,719 - INFO - Error processing batch 16: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,720 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,736 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,736 - INFO - Error processing batch 17: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,737 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,752 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,752 - INFO - Error processing batch 18: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,753 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,768 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,768 - INFO - Error processing batch 19: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,768 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,777 - INFO - Training batch 20
2025-04-11 22:01:36,784 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,784 - INFO - Error processing batch 20: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,784 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,799 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,800 - INFO - Error processing batch 21: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,800 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,815 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,815 - INFO - Error processing batch 22: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,816 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,833 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,833 - INFO - Error processing batch 23: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,834 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,849 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,850 - INFO - Error processing batch 24: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,850 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,860 - INFO - Training batch 25
2025-04-11 22:01:36,867 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,867 - INFO - Error processing batch 25: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,868 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,884 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,885 - INFO - Error processing batch 26: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,886 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,901 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,902 - INFO - Error processing batch 27: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,902 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,919 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,919 - INFO - Error processing batch 28: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,920 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,935 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,936 - INFO - Error processing batch 29: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,936 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,945 - INFO - Training batch 30
2025-04-11 22:01:36,952 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,952 - INFO - Error processing batch 30: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,953 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,967 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,967 - INFO - Error processing batch 31: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,968 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,983 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,983 - INFO - Error processing batch 32: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,983 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:36,998 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, Target type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:01:36,998 - INFO - Error processing batch 33: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:36,998 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 269, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,002 - INFO - Running validation...
2025-04-11 22:01:37,015 - INFO - Error in validation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,016 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,029 - INFO - Error in validation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,030 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,043 - INFO - Error in validation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,043 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,056 - INFO - Error in validation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,057 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,070 - INFO - Error in validation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,070 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,083 - INFO - Error in validation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,084 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,096 - INFO - Error in validation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,097 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,110 - INFO - Error in validation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,111 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,123 - INFO - Error in validation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:01:37,123 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 303, in train_model
    loss = loss_func(out, yb)
           ^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3480, in cross_entropy
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/overrides.py", line 1754, in handle_torch_function
    raise TypeError(msg)
TypeError: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]

2025-04-11 22:01:37,124 - INFO - No valid validation results available
2025-04-11 22:01:37,396 - INFO - Saved model for epoch 2
2025-04-11 22:01:37,397 - INFO - Simplified training completed
2025-04-11 22:01:37,702 - INFO - Model saved to simple_model.pth
2025-04-11 22:01:37,702 - INFO - Training process completed in 3.00s
2025-04-11 22:01:37,703 - INFO - Total processing time: 5.75s
2025-04-11 22:01:37,703 - INFO - ==================================================
2025-04-11 22:01:37,703 - INFO - Training completed successfully
2025-04-11 22:01:37,703 - INFO - ==================================================
2025-04-11 22:03:49,662 - INFO - ==================================================
2025-04-11 22:03:49,663 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:03:49,663 - INFO - ==================================================
2025-04-11 22:03:49,663 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:03:49,663 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:03:49,663 - INFO - FastAI version: 2.7.19
2025-04-11 22:03:49,680 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:03:49,680 - INFO - CUDA version: 12.4
2025-04-11 22:03:49,680 - INFO - Using device: cuda
2025-04-11 22:03:49,680 - INFO - Loading identity data...
2025-04-11 22:03:49,820 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:03:52,056 - INFO - Filtered out 1 missing images
2025-04-11 22:03:52,091 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:03:52,127 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:03:52,128 - INFO - Min images per class: 34
2025-04-11 22:03:52,128 - INFO - Max images per class: 35
2025-04-11 22:03:52,128 - INFO - Avg images per class: 34.6
2025-04-11 22:03:52,134 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:03:52,134 - INFO - Data loading completed in 2.45s
2025-04-11 22:03:52,134 - INFO - Creating databunch...
2025-04-11 22:03:52,136 - INFO - Training set: 138 images
2025-04-11 22:03:52,136 - INFO - Validation set: 35 images
2025-04-11 22:03:52,354 - INFO - Created databunch in 0.22s
2025-04-11 22:03:52,355 - INFO - Checking dataloaders...
2025-04-11 22:03:52,364 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:03:52,364 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:03:52,364 - INFO - Classes: 5 unique classes
2025-04-11 22:03:52,364 - INFO - Data device: cuda:0
2025-04-11 22:03:52,372 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:03:52,380 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:03:52,388 - INFO - Dataloader validation successful
2025-04-11 22:03:52,388 - INFO - DataLoaders creation completed in 2.71s
2025-04-11 22:03:52,388 - INFO - Starting model training...
2025-04-11 22:03:52,389 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:03:52,389 - INFO - Creating direct dataloader that yields standard PyTorch tensors...
2025-04-11 22:03:52,389 - INFO - Created direct dataloaders with standard PyTorch tensors
2025-04-11 22:03:52,389 - INFO - Creating learner with resnet18 architecture...
2025-04-11 22:03:52,517 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 22:03:53,035 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 22:03:53,060 - INFO - Moving model to device: cuda
2025-04-11 22:03:53,071 - INFO - Model is on device: cuda:0
2025-04-11 22:03:53,071 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 22:03:53,071 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 22:03:53,072 - INFO - Starting epoch 1/2
2025-04-11 22:03:53,081 - INFO - Training batch 0
2025-04-11 22:03:53,081 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,081 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,082 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,082 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,245 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,246 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,246 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,262 - INFO - Error processing batch 0: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,267 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,277 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,277 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,277 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,277 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,283 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,284 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,284 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,285 - INFO - Error processing batch 1: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,285 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,294 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,294 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,295 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,295 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,301 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,302 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,302 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,303 - INFO - Error processing batch 2: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,303 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,311 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,312 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,312 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,312 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,318 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,319 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,319 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,320 - INFO - Error processing batch 3: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,320 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,329 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,329 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,329 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,329 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,336 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,336 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,336 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,337 - INFO - Error processing batch 4: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,338 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,346 - INFO - Training batch 5
2025-04-11 22:03:53,346 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,347 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,347 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,347 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,353 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,353 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,354 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,355 - INFO - Error processing batch 5: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,355 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,364 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,364 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,364 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,364 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,370 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,371 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,371 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,372 - INFO - Error processing batch 6: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,373 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,381 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,381 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,382 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,382 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,388 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,388 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,389 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,390 - INFO - Error processing batch 7: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,390 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,399 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,399 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,399 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,399 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,405 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,406 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,406 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,407 - INFO - Error processing batch 8: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,408 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,416 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,416 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,416 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,417 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,423 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,423 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,423 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,424 - INFO - Error processing batch 9: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,425 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,434 - INFO - Training batch 10
2025-04-11 22:03:53,434 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,434 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,434 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,434 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,441 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,442 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,442 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,442 - INFO - Error processing batch 10: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,443 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,451 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,451 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,452 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,452 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,458 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,459 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,459 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,460 - INFO - Error processing batch 11: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,460 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,469 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,470 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,470 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,470 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,476 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,477 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,477 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,478 - INFO - Error processing batch 12: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,478 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,487 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,487 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,488 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,488 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,494 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,494 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,495 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,496 - INFO - Error processing batch 13: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,496 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,505 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,505 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,505 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,505 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,512 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,512 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,512 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,513 - INFO - Error processing batch 14: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,514 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,522 - INFO - Training batch 15
2025-04-11 22:03:53,522 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,522 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,522 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,523 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,529 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,530 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,530 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,531 - INFO - Error processing batch 15: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,531 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,540 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,541 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,541 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,541 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,547 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,548 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,548 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,549 - INFO - Error processing batch 16: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,549 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,558 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,558 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,558 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,558 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,565 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,565 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,565 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,566 - INFO - Error processing batch 17: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,567 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,576 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,576 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,576 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,576 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,582 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,583 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,583 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,584 - INFO - Error processing batch 18: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,584 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,594 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,594 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,594 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,594 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,600 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,601 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,601 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,602 - INFO - Error processing batch 19: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,603 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,611 - INFO - Training batch 20
2025-04-11 22:03:53,611 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,611 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,612 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,612 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,618 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,619 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,619 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,620 - INFO - Error processing batch 20: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,620 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,629 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,629 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,629 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,629 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,635 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,636 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,636 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,637 - INFO - Error processing batch 21: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,638 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,646 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,647 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,647 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,647 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,653 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,654 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,654 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,655 - INFO - Error processing batch 22: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,655 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,664 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,664 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,664 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,664 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,671 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,671 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,673 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,673 - INFO - Error processing batch 23: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,674 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,682 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,683 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,683 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,683 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,689 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,690 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,690 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,691 - INFO - Error processing batch 24: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,691 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,700 - INFO - Training batch 25
2025-04-11 22:03:53,700 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,700 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,701 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,701 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,707 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,708 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,708 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,709 - INFO - Error processing batch 25: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,709 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,718 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,718 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,718 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,718 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,724 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,725 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,725 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,726 - INFO - Error processing batch 26: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,727 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,735 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,736 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,736 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,736 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,742 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,743 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,743 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,744 - INFO - Error processing batch 27: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,744 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,753 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,753 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,754 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,754 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,760 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,760 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,761 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,762 - INFO - Error processing batch 28: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,762 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,771 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,771 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,771 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,771 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,778 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,778 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,778 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,779 - INFO - Error processing batch 29: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,780 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,788 - INFO - Training batch 30
2025-04-11 22:03:53,788 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,789 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,789 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,789 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,795 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,796 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,796 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,797 - INFO - Error processing batch 30: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,797 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,806 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,806 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,807 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,807 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,813 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,814 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,814 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,815 - INFO - Error processing batch 31: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,815 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,824 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,824 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,824 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,824 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,830 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,831 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,831 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,832 - INFO - Error processing batch 32: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,833 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,841 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,842 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,842 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:53,842 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:53,848 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:53,849 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:53,849 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:53,850 - INFO - Error processing batch 33: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:53,850 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:53,854 - INFO - Running validation...
2025-04-11 22:03:53,863 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,863 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,870 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,878 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,879 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,884 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,892 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,893 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,898 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,906 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,906 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,912 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,920 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,920 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,925 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,934 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,934 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,939 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,948 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,948 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,953 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,962 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,962 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,967 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,973 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:53,974 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:53,986 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:53,986 - INFO - No valid validation results available
2025-04-11 22:03:54,243 - INFO - Saved model for epoch 1
2025-04-11 22:03:54,243 - INFO - Starting epoch 2/2
2025-04-11 22:03:54,273 - INFO - Training batch 0
2025-04-11 22:03:54,273 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,273 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,274 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,274 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,295 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,297 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,297 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,298 - INFO - Error processing batch 0: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,299 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,327 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,328 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,328 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,329 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,349 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,351 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,351 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,352 - INFO - Error processing batch 1: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,354 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,376 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,376 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,376 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,377 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,387 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,388 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,388 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,389 - INFO - Error processing batch 2: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,389 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,400 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,401 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,401 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,401 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,408 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,409 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,409 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,409 - INFO - Error processing batch 3: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,410 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,418 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,418 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,419 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,419 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,425 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,425 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,425 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,426 - INFO - Error processing batch 4: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,427 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,435 - INFO - Training batch 5
2025-04-11 22:03:54,435 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,435 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,435 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,435 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,441 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,442 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,442 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,443 - INFO - Error processing batch 5: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,443 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,452 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,452 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,452 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,452 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,458 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,459 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,459 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,460 - INFO - Error processing batch 6: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,460 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,469 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,469 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,469 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,469 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,475 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,476 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,476 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,477 - INFO - Error processing batch 7: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,477 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,486 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,486 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,486 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,486 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,492 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,493 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,493 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,494 - INFO - Error processing batch 8: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,494 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,503 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,503 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,503 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,503 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,510 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,510 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,510 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,511 - INFO - Error processing batch 9: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,512 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,520 - INFO - Training batch 10
2025-04-11 22:03:54,520 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,520 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,521 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,521 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,527 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,527 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,527 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,528 - INFO - Error processing batch 10: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,529 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,537 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,537 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,538 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,538 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,544 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,544 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,544 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,545 - INFO - Error processing batch 11: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,546 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,555 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,555 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,555 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,555 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,561 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,562 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,562 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,563 - INFO - Error processing batch 12: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,563 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,571 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,572 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,572 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,572 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,578 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,579 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,579 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,580 - INFO - Error processing batch 13: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,580 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,588 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,589 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,589 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,589 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,595 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,596 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,596 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,597 - INFO - Error processing batch 14: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,597 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,606 - INFO - Training batch 15
2025-04-11 22:03:54,606 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,606 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,607 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,607 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,613 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,613 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,613 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,614 - INFO - Error processing batch 15: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,615 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,623 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,624 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,624 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,624 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,630 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,631 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,631 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,632 - INFO - Error processing batch 16: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,632 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,641 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,642 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,642 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,642 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,648 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,648 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,648 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,650 - INFO - Error processing batch 17: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,650 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,658 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,658 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,659 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,659 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,665 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,665 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,665 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,666 - INFO - Error processing batch 18: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,667 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,675 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,675 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,676 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,676 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,682 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,682 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,682 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,683 - INFO - Error processing batch 19: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,684 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,693 - INFO - Training batch 20
2025-04-11 22:03:54,693 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,693 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,693 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,693 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,699 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,700 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,700 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,701 - INFO - Error processing batch 20: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,701 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,710 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,710 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,710 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,710 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,716 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,717 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,717 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,718 - INFO - Error processing batch 21: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,718 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,727 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,727 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,727 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,728 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,734 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,734 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,734 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,735 - INFO - Error processing batch 22: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,736 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,744 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,744 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,744 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,744 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,750 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,751 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,751 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,752 - INFO - Error processing batch 23: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,752 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,761 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,761 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,761 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,761 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,767 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,768 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,768 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,769 - INFO - Error processing batch 24: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,769 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,778 - INFO - Training batch 25
2025-04-11 22:03:54,778 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,778 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,779 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,779 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,785 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,786 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,786 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,787 - INFO - Error processing batch 25: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,787 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,796 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,797 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,797 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,797 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,803 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,804 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,804 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,805 - INFO - Error processing batch 26: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,806 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,815 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,815 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,815 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,816 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,822 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,822 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,823 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,823 - INFO - Error processing batch 27: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,824 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,833 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,833 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,833 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,833 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,840 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,840 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,840 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,841 - INFO - Error processing batch 28: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,842 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,850 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,850 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,850 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,850 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,856 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,857 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,857 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,858 - INFO - Error processing batch 29: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,859 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,868 - INFO - Training batch 30
2025-04-11 22:03:54,868 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,868 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,869 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,869 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,875 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,875 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,876 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,877 - INFO - Error processing batch 30: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,877 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,886 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,886 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,886 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,887 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,893 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,894 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,894 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,895 - INFO - Error processing batch 31: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,895 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,904 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,904 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,904 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,905 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,911 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,912 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,912 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,912 - INFO - Error processing batch 32: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,913 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,922 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,922 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,923 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0
2025-04-11 22:03:54,923 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0
2025-04-11 22:03:54,929 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:03:54,929 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:03:54,929 - INFO - Attempting manual tensor conversion...
2025-04-11 22:03:54,930 - INFO - Error processing batch 33: element 0 of tensors does not require grad and does not have a grad_fn
2025-04-11 22:03:54,931 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 383, in train_model
    loss.backward()
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2025-04-11 22:03:54,935 - INFO - Running validation...
2025-04-11 22:03:54,943 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,943 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,948 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:54,956 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,957 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,962 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:54,970 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,970 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,975 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:54,983 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,983 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:54,988 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:54,996 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:54,997 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:55,001 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:55,010 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:55,010 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:55,015 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:55,024 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:55,024 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:55,029 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:55,037 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:55,038 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:55,043 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:55,049 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:03:55,050 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:03:55,055 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:03:55,055 - INFO - No valid validation results available
2025-04-11 22:03:55,283 - INFO - Saved model for epoch 2
2025-04-11 22:03:55,283 - INFO - Simplified training completed
2025-04-11 22:03:55,550 - INFO - Model saved to simple_model.pth
2025-04-11 22:03:55,550 - INFO - Training process completed in 3.16s
2025-04-11 22:03:55,550 - INFO - Total processing time: 5.87s
2025-04-11 22:03:55,551 - INFO - ==================================================
2025-04-11 22:03:55,551 - INFO - Training completed successfully
2025-04-11 22:03:55,551 - INFO - ==================================================
2025-04-11 22:06:14,028 - INFO - ==================================================
2025-04-11 22:06:14,028 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:06:14,028 - INFO - ==================================================
2025-04-11 22:06:14,028 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:06:14,028 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:06:14,029 - INFO - FastAI version: 2.7.19
2025-04-11 22:06:14,045 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:06:14,045 - INFO - CUDA version: 12.4
2025-04-11 22:06:14,045 - INFO - Using device: cuda
2025-04-11 22:06:14,046 - INFO - Loading identity data...
2025-04-11 22:06:14,186 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:06:16,465 - INFO - Filtered out 1 missing images
2025-04-11 22:06:16,500 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:06:16,536 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:06:16,537 - INFO - Min images per class: 34
2025-04-11 22:06:16,537 - INFO - Max images per class: 35
2025-04-11 22:06:16,537 - INFO - Avg images per class: 34.6
2025-04-11 22:06:16,549 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:06:16,550 - INFO - Data loading completed in 2.50s
2025-04-11 22:06:16,550 - INFO - Creating databunch...
2025-04-11 22:06:16,553 - INFO - Training set: 138 images
2025-04-11 22:06:16,554 - INFO - Validation set: 35 images
2025-04-11 22:06:16,788 - INFO - Created databunch in 0.24s
2025-04-11 22:06:16,788 - INFO - Checking dataloaders...
2025-04-11 22:06:16,798 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:06:16,799 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:06:16,799 - INFO - Classes: 5 unique classes
2025-04-11 22:06:16,799 - INFO - Data device: cuda:0
2025-04-11 22:06:16,809 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:06:16,818 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:06:16,827 - INFO - Dataloader validation successful
2025-04-11 22:06:16,828 - INFO - DataLoaders creation completed in 2.78s
2025-04-11 22:06:16,828 - INFO - Starting model training...
2025-04-11 22:06:16,829 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:06:16,829 - ERROR - Error during training: name 'create_direct_dataloader' is not defined
2025-04-11 22:06:16,830 - ERROR - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 242, in train_model
    direct_dls = create_direct_dataloader(dls)
                 ^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'create_direct_dataloader' is not defined

2025-04-11 22:06:16,830 - ERROR - Training failed: name 'create_direct_dataloader' is not defined
2025-04-11 22:06:16,830 - ERROR - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 630, in main
    learn = train_model(dls)
            ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/simpler_train.py", line 242, in train_model
    direct_dls = create_direct_dataloader(dls)
                 ^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'create_direct_dataloader' is not defined

2025-04-11 22:06:16,831 - INFO - ==================================================
2025-04-11 22:06:16,831 - INFO - Training failed - see log for details
2025-04-11 22:06:16,832 - INFO - ==================================================
2025-04-11 22:07:50,300 - INFO - ==================================================
2025-04-11 22:07:50,300 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:07:50,301 - INFO - ==================================================
2025-04-11 22:07:50,301 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:07:50,301 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:07:50,301 - INFO - FastAI version: 2.7.19
2025-04-11 22:07:50,318 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:07:50,318 - INFO - CUDA version: 12.4
2025-04-11 22:07:50,318 - INFO - Using device: cuda
2025-04-11 22:07:50,318 - INFO - Loading identity data...
2025-04-11 22:07:50,458 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:07:52,755 - INFO - Filtered out 1 missing images
2025-04-11 22:07:52,789 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:07:52,824 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:07:52,825 - INFO - Min images per class: 34
2025-04-11 22:07:52,825 - INFO - Max images per class: 35
2025-04-11 22:07:52,825 - INFO - Avg images per class: 34.6
2025-04-11 22:07:52,831 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:07:52,831 - INFO - Data loading completed in 2.51s
2025-04-11 22:07:52,831 - INFO - Creating databunch...
2025-04-11 22:07:52,833 - INFO - Training set: 138 images
2025-04-11 22:07:52,833 - INFO - Validation set: 35 images
2025-04-11 22:07:53,064 - INFO - Created databunch in 0.23s
2025-04-11 22:07:53,064 - INFO - Checking dataloaders...
2025-04-11 22:07:53,073 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:07:53,073 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:07:53,074 - INFO - Classes: 5 unique classes
2025-04-11 22:07:53,074 - INFO - Data device: cuda:0
2025-04-11 22:07:53,083 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:07:53,091 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:07:53,100 - INFO - Dataloader validation successful
2025-04-11 22:07:53,101 - INFO - DataLoaders creation completed in 2.78s
2025-04-11 22:07:53,101 - INFO - Starting model training...
2025-04-11 22:07:53,101 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:07:53,102 - INFO - Creating direct dataloader that yields standard PyTorch tensors...
2025-04-11 22:07:53,102 - INFO - Created direct dataloaders with standard PyTorch tensors
2025-04-11 22:07:53,102 - INFO - Creating learner with resnet18 architecture...
2025-04-11 22:07:53,231 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 22:07:53,591 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 22:07:53,627 - INFO - Moving model to device: cuda
2025-04-11 22:07:53,638 - INFO - Model is on device: cuda:0
2025-04-11 22:07:53,639 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 22:07:53,639 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 22:07:53,639 - INFO - Starting epoch 1/2
2025-04-11 22:07:53,648 - INFO - Training batch 0
2025-04-11 22:07:53,648 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,648 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,648 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:53,648 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:53,814 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:53,814 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:53,815 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,815 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,830 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 0
2025-04-11 22:07:53,839 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,840 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,847 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,847 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,848 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 1
2025-04-11 22:07:53,856 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,856 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,863 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,863 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,864 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 2
2025-04-11 22:07:53,873 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,873 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,880 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,880 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,881 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 3
2025-04-11 22:07:53,890 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,890 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,896 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,897 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,898 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 4
2025-04-11 22:07:53,906 - INFO - Training batch 5
2025-04-11 22:07:53,906 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,907 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,913 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,913 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,915 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 5
2025-04-11 22:07:53,923 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,924 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,930 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,930 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,932 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 6
2025-04-11 22:07:53,940 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,940 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,947 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,947 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,948 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 7
2025-04-11 22:07:53,956 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,957 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,963 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,964 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,965 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 8
2025-04-11 22:07:53,973 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,973 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,980 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,980 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,982 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 9
2025-04-11 22:07:53,990 - INFO - Training batch 10
2025-04-11 22:07:53,990 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:53,991 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:53,991 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:53,991 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:53,998 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:53,998 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:53,999 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:53,999 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:53,999 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 10
2025-04-11 22:07:54,008 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,008 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,015 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,015 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,016 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 11
2025-04-11 22:07:54,025 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,025 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,032 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,032 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,033 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 12
2025-04-11 22:07:54,042 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,042 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,049 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,049 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,050 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 13
2025-04-11 22:07:54,058 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,059 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,065 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,066 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,067 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 14
2025-04-11 22:07:54,075 - INFO - Training batch 15
2025-04-11 22:07:54,075 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,076 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,083 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,083 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,084 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 15
2025-04-11 22:07:54,092 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,093 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,099 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,100 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,101 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 16
2025-04-11 22:07:54,110 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,110 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,117 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,117 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,118 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 17
2025-04-11 22:07:54,126 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,127 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,134 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,134 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,135 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 18
2025-04-11 22:07:54,143 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,144 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,150 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,150 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,152 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 19
2025-04-11 22:07:54,160 - INFO - Training batch 20
2025-04-11 22:07:54,161 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,161 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,161 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,161 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,168 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:54,168 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:54,168 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,169 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,169 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 20
2025-04-11 22:07:54,178 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,178 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,185 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,185 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,186 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 21
2025-04-11 22:07:54,196 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,196 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,203 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,204 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,205 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 22
2025-04-11 22:07:54,213 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,214 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,221 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,221 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,222 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 23
2025-04-11 22:07:54,231 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,231 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,238 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,239 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,240 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 24
2025-04-11 22:07:54,248 - INFO - Training batch 25
2025-04-11 22:07:54,249 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,249 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,256 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,256 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,257 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 25
2025-04-11 22:07:54,266 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,266 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,273 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,273 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,274 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 26
2025-04-11 22:07:54,282 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,283 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,290 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,290 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,291 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 27
2025-04-11 22:07:54,299 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,300 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,307 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,307 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,308 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 28
2025-04-11 22:07:54,316 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,316 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,323 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,324 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,325 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 29
2025-04-11 22:07:54,333 - INFO - Training batch 30
2025-04-11 22:07:54,334 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,334 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,334 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,335 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,341 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:54,341 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:54,342 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,343 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,343 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 30
2025-04-11 22:07:54,352 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,353 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,359 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,360 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,361 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 31
2025-04-11 22:07:54,369 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,370 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,377 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,377 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,378 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 32
2025-04-11 22:07:54,386 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,387 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,394 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,394 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,395 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 33
2025-04-11 22:07:54,399 - INFO - Running validation...
2025-04-11 22:07:54,408 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,409 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,415 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,424 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,425 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,430 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,439 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,439 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,445 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,453 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,454 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,459 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,468 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,468 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,473 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,482 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,483 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,488 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,497 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,497 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,502 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,511 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,512 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,517 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,524 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,525 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,537 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:54,538 - INFO - No valid validation results available
2025-04-11 22:07:54,795 - INFO - Saved model for epoch 1
2025-04-11 22:07:54,795 - INFO - Starting epoch 2/2
2025-04-11 22:07:54,826 - INFO - Training batch 0
2025-04-11 22:07:54,826 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,827 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,828 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,828 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:54,849 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:54,850 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:54,852 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,852 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,854 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 0
2025-04-11 22:07:54,880 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,880 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,893 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,894 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,894 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 1
2025-04-11 22:07:54,907 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,907 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,915 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,915 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,916 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 2
2025-04-11 22:07:54,925 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,925 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,932 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,932 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,933 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 3
2025-04-11 22:07:54,942 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,942 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,949 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,949 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,950 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 4
2025-04-11 22:07:54,959 - INFO - Training batch 5
2025-04-11 22:07:54,959 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,959 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,966 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,966 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,967 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 5
2025-04-11 22:07:54,975 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,976 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,982 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,982 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:54,984 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 6
2025-04-11 22:07:54,992 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:54,992 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:54,999 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:54,999 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,000 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 7
2025-04-11 22:07:55,009 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,009 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,016 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,016 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,017 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 8
2025-04-11 22:07:55,025 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,026 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,033 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,033 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,034 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 9
2025-04-11 22:07:55,042 - INFO - Training batch 10
2025-04-11 22:07:55,043 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,043 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,043 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,043 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,050 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:55,050 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:55,050 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,051 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,051 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 10
2025-04-11 22:07:55,060 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,060 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,067 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,067 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,068 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 11
2025-04-11 22:07:55,077 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,077 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,083 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,084 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,085 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 12
2025-04-11 22:07:55,093 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,094 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,100 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,101 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,102 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 13
2025-04-11 22:07:55,110 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,111 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,117 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,117 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,119 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 14
2025-04-11 22:07:55,127 - INFO - Training batch 15
2025-04-11 22:07:55,127 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,128 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,134 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,135 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,136 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 15
2025-04-11 22:07:55,144 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,145 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,152 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,152 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,153 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 16
2025-04-11 22:07:55,161 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,162 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,168 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,169 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,170 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 17
2025-04-11 22:07:55,178 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,178 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,185 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,185 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,186 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 18
2025-04-11 22:07:55,195 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,195 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,202 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,202 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,203 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 19
2025-04-11 22:07:55,212 - INFO - Training batch 20
2025-04-11 22:07:55,212 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,212 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,213 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,213 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,219 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:55,219 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:55,220 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,220 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,221 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 20
2025-04-11 22:07:55,229 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,229 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,236 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,236 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,237 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 21
2025-04-11 22:07:55,246 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,246 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,253 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,253 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,254 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 22
2025-04-11 22:07:55,263 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,263 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,270 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,270 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,271 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 23
2025-04-11 22:07:55,280 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,280 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,287 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,287 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,288 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 24
2025-04-11 22:07:55,296 - INFO - Training batch 25
2025-04-11 22:07:55,296 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,297 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,303 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,304 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,305 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 25
2025-04-11 22:07:55,313 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,314 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,321 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,321 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,322 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 26
2025-04-11 22:07:55,330 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,331 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,337 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,338 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,338 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 27
2025-04-11 22:07:55,347 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,347 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,354 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,354 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,355 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 28
2025-04-11 22:07:55,364 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,364 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,371 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,371 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,372 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 29
2025-04-11 22:07:55,381 - INFO - Training batch 30
2025-04-11 22:07:55,381 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,381 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,382 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,382 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:07:55,388 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:07:55,388 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:07:55,389 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,389 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,390 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 30
2025-04-11 22:07:55,398 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,398 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,405 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,405 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,406 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 31
2025-04-11 22:07:55,415 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,415 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,422 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,422 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,423 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 32
2025-04-11 22:07:55,432 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,432 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,439 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:07:55,439 - INFO - Attempting manual tensor conversion...
2025-04-11 22:07:55,440 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 33
2025-04-11 22:07:55,444 - INFO - Running validation...
2025-04-11 22:07:55,453 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,453 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,458 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,466 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,467 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,472 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,480 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,481 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,486 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,494 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,494 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,499 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,508 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,509 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,514 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,523 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,523 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,528 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,537 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,537 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,543 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,551 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,552 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,557 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,564 - INFO - Converting non-standard validation input tensor: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:07:55,564 - INFO - Converting non-standard validation target tensor: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:07:55,570 - INFO - TypeError in validation loss calculation, skipping
2025-04-11 22:07:55,570 - INFO - No valid validation results available
2025-04-11 22:07:55,839 - INFO - Saved model for epoch 2
2025-04-11 22:07:55,839 - INFO - Simplified training completed
2025-04-11 22:07:56,129 - INFO - Model saved to simple_model.pth
2025-04-11 22:07:56,129 - INFO - Training process completed in 3.03s
2025-04-11 22:07:56,129 - INFO - Total processing time: 5.81s
2025-04-11 22:07:56,130 - INFO - ==================================================
2025-04-11 22:07:56,130 - INFO - Training completed successfully
2025-04-11 22:07:56,130 - INFO - ==================================================
2025-04-11 22:10:15,590 - INFO - ==================================================
2025-04-11 22:10:15,590 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:10:15,590 - INFO - ==================================================
2025-04-11 22:10:15,590 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:10:15,590 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:10:15,590 - INFO - FastAI version: 2.7.19
2025-04-11 22:10:15,607 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:10:15,607 - INFO - CUDA version: 12.4
2025-04-11 22:10:15,607 - INFO - Using device: cuda
2025-04-11 22:10:15,607 - INFO - Loading identity data...
2025-04-11 22:10:15,750 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:10:18,017 - INFO - Filtered out 1 missing images
2025-04-11 22:10:18,052 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:10:18,087 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:10:18,087 - INFO - Min images per class: 34
2025-04-11 22:10:18,087 - INFO - Max images per class: 35
2025-04-11 22:10:18,087 - INFO - Avg images per class: 34.6
2025-04-11 22:10:18,100 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:10:18,101 - INFO - Data loading completed in 2.49s
2025-04-11 22:10:18,101 - INFO - Creating databunch...
2025-04-11 22:10:18,104 - INFO - Training set: 138 images
2025-04-11 22:10:18,104 - INFO - Validation set: 35 images
2025-04-11 22:10:18,345 - INFO - Created databunch in 0.24s
2025-04-11 22:10:18,345 - INFO - Checking dataloaders...
2025-04-11 22:10:18,355 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:10:18,355 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:10:18,355 - INFO - Classes: 5 unique classes
2025-04-11 22:10:18,355 - INFO - Data device: cuda:0
2025-04-11 22:10:18,363 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:10:18,371 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:10:18,379 - INFO - Dataloader validation successful
2025-04-11 22:10:18,380 - INFO - DataLoaders creation completed in 2.77s
2025-04-11 22:10:18,380 - INFO - Starting model training...
2025-04-11 22:10:18,380 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:10:18,380 - INFO - Creating direct dataloader that yields standard PyTorch tensors...
2025-04-11 22:10:18,381 - INFO - Created direct dataloaders with standard PyTorch tensors
2025-04-11 22:10:18,381 - INFO - Creating learner with resnet18 architecture...
2025-04-11 22:10:18,508 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-11 22:10:18,875 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-11 22:10:18,910 - INFO - Moving model to device: cuda
2025-04-11 22:10:18,921 - INFO - Model is on device: cuda:0
2025-04-11 22:10:18,921 - INFO - Mixed precision disabled for diagnostic training
2025-04-11 22:10:18,922 - INFO - Using ultra-simple training with minimal callbacks
2025-04-11 22:10:18,922 - INFO - Starting epoch 1/2
2025-04-11 22:10:18,931 - INFO - Training batch 0
2025-04-11 22:10:18,931 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:18,931 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:18,931 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:18,931 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,095 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:19,095 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:19,096 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,096 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,111 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 0
2025-04-11 22:10:19,120 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,120 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,127 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,127 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,128 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 1
2025-04-11 22:10:19,136 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,136 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,143 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,143 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,144 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 2
2025-04-11 22:10:19,152 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,153 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,159 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,159 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,161 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 3
2025-04-11 22:10:19,169 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,170 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,176 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,176 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,178 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 4
2025-04-11 22:10:19,186 - INFO - Training batch 5
2025-04-11 22:10:19,186 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,186 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,192 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,193 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,194 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 5
2025-04-11 22:10:19,202 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,202 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,209 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,209 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,210 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 6
2025-04-11 22:10:19,218 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,218 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,225 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,225 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,226 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 7
2025-04-11 22:10:19,234 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,235 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,241 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,241 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,242 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 8
2025-04-11 22:10:19,251 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,251 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,257 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,257 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,259 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 9
2025-04-11 22:10:19,267 - INFO - Training batch 10
2025-04-11 22:10:19,267 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,267 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,267 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,268 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,274 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:19,274 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:19,275 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,275 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,275 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 10
2025-04-11 22:10:19,284 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,284 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,290 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,291 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,292 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 11
2025-04-11 22:10:19,300 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,300 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,307 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,307 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,308 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 12
2025-04-11 22:10:19,316 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,316 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,323 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,323 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,324 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 13
2025-04-11 22:10:19,332 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,333 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,339 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,339 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,340 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 14
2025-04-11 22:10:19,348 - INFO - Training batch 15
2025-04-11 22:10:19,349 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,349 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,355 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,355 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,357 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 15
2025-04-11 22:10:19,365 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,365 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,372 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,372 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,373 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 16
2025-04-11 22:10:19,381 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,382 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,388 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,388 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,389 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 17
2025-04-11 22:10:19,398 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,398 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,404 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,405 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,406 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 18
2025-04-11 22:10:19,414 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,414 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,421 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,421 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,422 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 19
2025-04-11 22:10:19,430 - INFO - Training batch 20
2025-04-11 22:10:19,430 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,431 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,431 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,431 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,437 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:19,437 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:19,438 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,438 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,439 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 20
2025-04-11 22:10:19,447 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,448 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,454 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,454 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,455 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 21
2025-04-11 22:10:19,464 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,464 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,470 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,471 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,472 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 22
2025-04-11 22:10:19,480 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,480 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,487 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,487 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,488 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 23
2025-04-11 22:10:19,496 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,497 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,503 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,503 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,504 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 24
2025-04-11 22:10:19,513 - INFO - Training batch 25
2025-04-11 22:10:19,513 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,513 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,520 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,520 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,521 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 25
2025-04-11 22:10:19,529 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,530 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,536 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,536 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,537 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 26
2025-04-11 22:10:19,546 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,546 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,553 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,553 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,554 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 27
2025-04-11 22:10:19,562 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,563 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,569 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,569 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,570 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 28
2025-04-11 22:10:19,579 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,579 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,586 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,586 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,588 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 29
2025-04-11 22:10:19,596 - INFO - Training batch 30
2025-04-11 22:10:19,597 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,597 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,598 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,598 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:19,604 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:19,605 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:19,605 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,606 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,606 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 30
2025-04-11 22:10:19,615 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,616 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,623 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,623 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,624 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 31
2025-04-11 22:10:19,633 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,633 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,640 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,640 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,641 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 32
2025-04-11 22:10:19,650 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:19,650 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,657 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,657 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:19,658 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 33
2025-04-11 22:10:19,662 - INFO - Running validation...
2025-04-11 22:10:19,670 - INFO - Processing validation batch 0
2025-04-11 22:10:19,671 - INFO - Validation batch types - input: <class 'fastai.torch_core.TensorImage'>, target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,671 - INFO - Target shape: torch.Size([4]), dtype: torch.int64
2025-04-11 22:10:19,678 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:10:19,678 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4]), dtype: torch.int64
2025-04-11 22:10:19,678 - INFO - TypeError in validation loss calculation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,679 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,679 - INFO - Target values: TensorCategory([3, 2, 3, 0], device='cuda:0')
2025-04-11 22:10:19,693 - INFO - TypeError in validation loss calculation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,693 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,694 - INFO - Target values: TensorCategory([0, 3, 2, 3], device='cuda:0')
2025-04-11 22:10:19,708 - INFO - TypeError in validation loss calculation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,708 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,710 - INFO - Target values: TensorCategory([2, 0, 2, 2], device='cuda:0')
2025-04-11 22:10:19,722 - INFO - TypeError in validation loss calculation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,723 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,724 - INFO - Target values: TensorCategory([3, 2, 0, 0], device='cuda:0')
2025-04-11 22:10:19,737 - INFO - TypeError in validation loss calculation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,737 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:19,738 - INFO - Target values: TensorCategory([2, 3, 0, 3], device='cuda:0')
2025-04-11 22:10:19,751 - INFO - TypeError in validation loss calculation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,764 - INFO - TypeError in validation loss calculation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,777 - INFO - TypeError in validation loss calculation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,795 - INFO - TypeError in validation loss calculation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:19,795 - INFO - No valid validation results available
2025-04-11 22:10:20,048 - INFO - Saved model for epoch 1
2025-04-11 22:10:20,049 - INFO - Starting epoch 2/2
2025-04-11 22:10:20,076 - INFO - Training batch 0
2025-04-11 22:10:20,077 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,077 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,078 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,078 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,097 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:20,098 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:20,099 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,099 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,101 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 0
2025-04-11 22:10:20,125 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,126 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,146 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,147 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,148 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 1
2025-04-11 22:10:20,168 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,169 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,180 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,180 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,180 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 2
2025-04-11 22:10:20,192 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,192 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,200 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,200 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,201 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 3
2025-04-11 22:10:20,209 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,209 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,216 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,216 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,217 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 4
2025-04-11 22:10:20,225 - INFO - Training batch 5
2025-04-11 22:10:20,225 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,226 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,232 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,232 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,233 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 5
2025-04-11 22:10:20,242 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,242 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,249 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,249 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,250 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 6
2025-04-11 22:10:20,259 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,259 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,266 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,266 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,267 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 7
2025-04-11 22:10:20,275 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,276 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,283 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,283 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,284 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 8
2025-04-11 22:10:20,292 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,292 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,299 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,299 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,300 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 9
2025-04-11 22:10:20,308 - INFO - Training batch 10
2025-04-11 22:10:20,309 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,309 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,309 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,309 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,316 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:20,316 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:20,317 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,317 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,317 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 10
2025-04-11 22:10:20,325 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,326 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,333 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,333 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,334 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 11
2025-04-11 22:10:20,342 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,343 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,350 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,350 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,351 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 12
2025-04-11 22:10:20,359 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,360 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,367 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,367 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,368 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 13
2025-04-11 22:10:20,376 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,377 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,383 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,384 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,385 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 14
2025-04-11 22:10:20,393 - INFO - Training batch 15
2025-04-11 22:10:20,393 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,394 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,400 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,401 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,401 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 15
2025-04-11 22:10:20,410 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,410 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,417 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,417 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,418 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 16
2025-04-11 22:10:20,426 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,427 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,434 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,434 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,435 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 17
2025-04-11 22:10:20,443 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,444 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,450 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,451 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,452 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 18
2025-04-11 22:10:20,460 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,461 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,467 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,468 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,468 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 19
2025-04-11 22:10:20,477 - INFO - Training batch 20
2025-04-11 22:10:20,477 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,478 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,478 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,478 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,484 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:20,485 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:20,485 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,486 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,486 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 20
2025-04-11 22:10:20,495 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,495 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,502 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,502 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,503 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 21
2025-04-11 22:10:20,511 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,512 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,519 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,519 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,520 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 22
2025-04-11 22:10:20,528 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,529 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,535 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,536 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,536 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 23
2025-04-11 22:10:20,545 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,545 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,552 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,553 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,553 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 24
2025-04-11 22:10:20,562 - INFO - Training batch 25
2025-04-11 22:10:20,562 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,562 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,569 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,569 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,570 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 25
2025-04-11 22:10:20,579 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,579 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,586 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,586 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,587 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 26
2025-04-11 22:10:20,595 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,596 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,603 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,603 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,604 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 27
2025-04-11 22:10:20,612 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,613 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,619 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,620 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,621 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 28
2025-04-11 22:10:20,629 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,629 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,636 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,637 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,637 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 29
2025-04-11 22:10:20,646 - INFO - Training batch 30
2025-04-11 22:10:20,646 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,647 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,647 - INFO - Input tensor type: <class 'fastai.torch_core.TensorImage'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,647 - INFO - Target tensor type: <class 'fastai.torch_core.TensorCategory'>, device: cuda:0, requires_grad: False
2025-04-11 22:10:20,654 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), requires_grad: True
2025-04-11 22:10:20,654 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4])
2025-04-11 22:10:20,655 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,655 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,656 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 30
2025-04-11 22:10:20,664 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,664 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,671 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,672 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,672 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 31
2025-04-11 22:10:20,681 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,682 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,688 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,689 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,690 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 32
2025-04-11 22:10:20,698 - INFO - Converting non-standard input tensor type: <class 'fastai.torch_core.TensorImage'>
2025-04-11 22:10:20,698 - INFO - Converting non-standard target tensor type: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,705 - INFO - TypeError in loss calculation: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,705 - INFO - Attempting manual tensor conversion...
2025-04-11 22:10:20,706 - INFO - Warning: Loss has no grad_fn, cannot backpropagate. Skipping batch 33
2025-04-11 22:10:20,710 - INFO - Running validation...
2025-04-11 22:10:20,719 - INFO - Processing validation batch 0
2025-04-11 22:10:20,719 - INFO - Validation batch types - input: <class 'fastai.torch_core.TensorImage'>, target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,719 - INFO - Target shape: torch.Size([4]), dtype: torch.int64
2025-04-11 22:10:20,724 - INFO - Output type: <class 'fastai.torch_core.TensorImage'>, shape: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:10:20,725 - INFO - Target type: <class 'fastai.torch_core.TensorCategory'>, shape: torch.Size([4]), dtype: torch.int64
2025-04-11 22:10:20,725 - INFO - TypeError in validation loss calculation batch 0: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,725 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,726 - INFO - Target values: TensorCategory([3, 2, 3, 0], device='cuda:0')
2025-04-11 22:10:20,739 - INFO - TypeError in validation loss calculation batch 1: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,739 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,740 - INFO - Target values: TensorCategory([0, 3, 2, 3], device='cuda:0')
2025-04-11 22:10:20,753 - INFO - TypeError in validation loss calculation batch 2: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,754 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,755 - INFO - Target values: TensorCategory([2, 0, 2, 2], device='cuda:0')
2025-04-11 22:10:20,768 - INFO - TypeError in validation loss calculation batch 3: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,768 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,769 - INFO - Target values: TensorCategory([3, 2, 0, 0], device='cuda:0')
2025-04-11 22:10:20,782 - INFO - TypeError in validation loss calculation batch 4: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,783 - INFO - DEBUG - Output: <class 'fastai.torch_core.TensorImage'>, Target: <class 'fastai.torch_core.TensorCategory'>
2025-04-11 22:10:20,784 - INFO - Target values: TensorCategory([2, 3, 0, 3], device='cuda:0')
2025-04-11 22:10:20,797 - INFO - TypeError in validation loss calculation batch 5: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,810 - INFO - TypeError in validation loss calculation batch 6: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,823 - INFO - TypeError in validation loss calculation batch 7: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,835 - INFO - TypeError in validation loss calculation batch 8: no implementation found for 'torch.nn.functional.cross_entropy' on types that implement __torch_function__: [<class 'fastai.torch_core.TensorImage'>, <class 'fastai.torch_core.TensorCategory'>]
2025-04-11 22:10:20,835 - INFO - No valid validation results available
2025-04-11 22:10:21,091 - INFO - Saved model for epoch 2
2025-04-11 22:10:21,091 - INFO - Simplified training completed
2025-04-11 22:10:21,391 - INFO - Model saved to simple_model.pth
2025-04-11 22:10:21,392 - INFO - Training process completed in 3.01s
2025-04-11 22:10:21,392 - INFO - Total processing time: 5.78s
2025-04-11 22:10:21,392 - INFO - ==================================================
2025-04-11 22:10:21,392 - INFO - Training completed successfully
2025-04-11 22:10:21,393 - INFO - ==================================================
2025-04-11 22:12:47,520 - INFO - ==================================================
2025-04-11 22:12:47,520 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:12:47,521 - INFO - ==================================================
2025-04-11 22:12:47,521 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:12:47,521 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:12:47,521 - INFO - FastAI version: 2.7.19
2025-04-11 22:12:47,538 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:12:47,538 - INFO - CUDA version: 12.4
2025-04-11 22:12:47,538 - INFO - Using device: cuda
2025-04-11 22:12:47,538 - INFO - Loading identity data...
2025-04-11 22:12:47,677 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:12:49,936 - INFO - Filtered out 1 missing images
2025-04-11 22:12:49,971 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:12:50,007 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:12:50,007 - INFO - Min images per class: 34
2025-04-11 22:12:50,007 - INFO - Max images per class: 35
2025-04-11 22:12:50,007 - INFO - Avg images per class: 34.6
2025-04-11 22:12:50,013 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:12:50,014 - INFO - Data loading completed in 2.48s
2025-04-11 22:12:50,014 - INFO - Creating databunch...
2025-04-11 22:12:50,015 - INFO - Training set: 138 images
2025-04-11 22:12:50,015 - INFO - Validation set: 35 images
2025-04-11 22:12:50,241 - INFO - Created databunch in 0.23s
2025-04-11 22:12:50,241 - INFO - Checking dataloaders...
2025-04-11 22:12:50,251 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:12:50,251 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:12:50,251 - INFO - Classes: 5 unique classes
2025-04-11 22:12:50,251 - INFO - Data device: cuda:0
2025-04-11 22:12:50,259 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:12:50,268 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:12:50,276 - INFO - Dataloader validation successful
2025-04-11 22:12:50,277 - INFO - DataLoaders creation completed in 2.74s
2025-04-11 22:12:50,277 - INFO - Starting model training...
2025-04-11 22:12:50,277 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:12:50,277 - INFO - ========================================
2025-04-11 22:12:50,278 - INFO - USING PURE PYTORCH TRAINING
2025-04-11 22:12:50,278 - INFO - ========================================
2025-04-11 22:12:50,278 - INFO - Creating pure PyTorch datasets...
2025-04-11 22:12:50,278 - INFO - Extracting training data...
2025-04-11 22:12:50,287 - INFO - Processed 0 training batches
2025-04-11 22:12:50,372 - INFO - Processed 10 training batches
2025-04-11 22:12:50,459 - INFO - Processed 20 training batches
2025-04-11 22:12:50,545 - INFO - Processed 30 training batches
2025-04-11 22:12:50,575 - INFO - Extracting validation data...
2025-04-11 22:12:50,584 - INFO - Processed 0 validation batches
2025-04-11 22:12:59,839 - INFO - Model will classify 5 classes
2025-04-11 22:12:59,850 - INFO - PyTorch Direct - Epoch 1/2
2025-04-11 22:12:59,851 - INFO - PyTorch batch 0
2025-04-11 22:12:59,852 - INFO - Error in PyTorch training batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,857 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,859 - INFO - Error in PyTorch training batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,859 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,861 - INFO - Error in PyTorch training batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,862 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,864 - INFO - Error in PyTorch training batch 3: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,865 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,866 - INFO - Error in PyTorch training batch 4: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,867 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,868 - INFO - PyTorch batch 5
2025-04-11 22:12:59,869 - INFO - Error in PyTorch training batch 5: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,870 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,872 - INFO - Error in PyTorch training batch 6: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,872 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,874 - INFO - Error in PyTorch training batch 7: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,875 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,876 - INFO - Error in PyTorch training batch 8: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [2, 4, 3, 128, 128]
2025-04-11 22:12:59,877 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [2, 4, 3, 128, 128]

2025-04-11 22:12:59,879 - INFO - Validation tensors - inputs: torch.Size([4, 4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:12:59,879 - INFO - Validation tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:12:59,879 - INFO - Error in PyTorch validation batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,880 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,881 - INFO - Error in PyTorch validation batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,882 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,883 - INFO - Error in PyTorch validation batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]
2025-04-11 22:12:59,884 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]

2025-04-11 22:12:59,887 - INFO - PyTorch Direct - Epoch 2/2
2025-04-11 22:12:59,888 - INFO - PyTorch batch 0
2025-04-11 22:12:59,889 - INFO - Error in PyTorch training batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,890 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,891 - INFO - Error in PyTorch training batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,892 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,894 - INFO - Error in PyTorch training batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,895 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,896 - INFO - Error in PyTorch training batch 3: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,897 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,908 - INFO - Error in PyTorch training batch 4: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,909 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,911 - INFO - PyTorch batch 5
2025-04-11 22:12:59,912 - INFO - Error in PyTorch training batch 5: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,913 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,916 - INFO - Error in PyTorch training batch 6: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,916 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,919 - INFO - Error in PyTorch training batch 7: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,919 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,922 - INFO - Error in PyTorch training batch 8: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [2, 4, 3, 128, 128]
2025-04-11 22:12:59,923 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 561, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [2, 4, 3, 128, 128]

2025-04-11 22:12:59,926 - INFO - Validation tensors - inputs: torch.Size([4, 4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:12:59,926 - INFO - Validation tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:12:59,927 - INFO - Error in PyTorch validation batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,927 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,930 - INFO - Error in PyTorch validation batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:12:59,931 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:12:59,933 - INFO - Error in PyTorch validation batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]
2025-04-11 22:12:59,934 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 614, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]

2025-04-11 22:12:59,983 - INFO - Saved pure PyTorch model to models/pure_pytorch_model.pth
2025-04-11 22:12:59,983 - INFO - Created standalone prediction script: pytorch_predict.py
2025-04-11 22:12:59,983 - INFO - Saved vocabulary to models/vocab.pkl
2025-04-11 22:12:59,983 - INFO - Total processing time: 12.45s
2025-04-11 22:12:59,984 - INFO - ==================================================
2025-04-11 22:12:59,984 - INFO - Training completed successfully
2025-04-11 22:12:59,984 - INFO - ==================================================
2025-04-11 22:14:32,638 - INFO - ==================================================
2025-04-11 22:14:32,638 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:14:32,639 - INFO - ==================================================
2025-04-11 22:14:32,639 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:14:32,639 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:14:32,639 - INFO - FastAI version: 2.7.19
2025-04-11 22:14:32,656 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:14:32,656 - INFO - CUDA version: 12.4
2025-04-11 22:14:32,656 - INFO - Using device: cuda
2025-04-11 22:14:32,656 - INFO - Loading identity data...
2025-04-11 22:14:32,797 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:14:35,057 - INFO - Filtered out 1 missing images
2025-04-11 22:14:35,092 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:14:35,127 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:14:35,128 - INFO - Min images per class: 34
2025-04-11 22:14:35,128 - INFO - Max images per class: 35
2025-04-11 22:14:35,128 - INFO - Avg images per class: 34.6
2025-04-11 22:14:35,134 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:14:35,134 - INFO - Data loading completed in 2.48s
2025-04-11 22:14:35,135 - INFO - Creating databunch...
2025-04-11 22:14:35,136 - INFO - Training set: 138 images
2025-04-11 22:14:35,136 - INFO - Validation set: 35 images
2025-04-11 22:14:35,364 - INFO - Created databunch in 0.23s
2025-04-11 22:14:35,364 - INFO - Checking dataloaders...
2025-04-11 22:14:35,373 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:14:35,374 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:14:35,374 - INFO - Classes: 5 unique classes
2025-04-11 22:14:35,374 - INFO - Data device: cuda:0
2025-04-11 22:14:35,382 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:14:35,391 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:14:35,399 - INFO - Dataloader validation successful
2025-04-11 22:14:35,399 - INFO - DataLoaders creation completed in 2.74s
2025-04-11 22:14:35,399 - INFO - Starting model training...
2025-04-11 22:14:35,399 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:14:35,399 - INFO - ========================================
2025-04-11 22:14:35,399 - INFO - USING PURE PYTORCH TRAINING
2025-04-11 22:14:35,400 - INFO - ========================================
2025-04-11 22:14:35,400 - INFO - Creating pure PyTorch datasets...
2025-04-11 22:14:35,400 - INFO - Extracting training data...
2025-04-11 22:14:35,408 - INFO - Processed 0 training batches
2025-04-11 22:14:35,493 - INFO - Processed 10 training batches
2025-04-11 22:14:35,577 - INFO - Processed 20 training batches
2025-04-11 22:14:35,662 - INFO - Processed 30 training batches
2025-04-11 22:14:35,692 - INFO - Extracting validation data...
2025-04-11 22:14:35,701 - INFO - Processed 0 validation batches
2025-04-11 22:14:35,928 - INFO - Model will classify 5 classes
2025-04-11 22:14:35,939 - INFO - PyTorch Direct - Epoch 1/2
2025-04-11 22:14:35,940 - INFO - PyTorch batch 0
2025-04-11 22:14:35,940 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:35,940 - INFO - Input shape after fixing: torch.Size([16, 3, 128, 128])
2025-04-11 22:14:35,940 - INFO - Target shape: torch.Size([4, 4])
2025-04-11 22:14:36,075 - INFO - Training tensors - inputs: torch.Size([16, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:14:36,075 - INFO - Training tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:14:36,075 - INFO - Training tensors - outputs: torch.Size([16, 5]), dtype: torch.float32
2025-04-11 22:14:36,086 - INFO - Error in PyTorch training batch 0: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,088 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,089 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,095 - INFO - Error in PyTorch training batch 1: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,095 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,096 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,109 - INFO - Error in PyTorch training batch 2: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,110 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,111 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,126 - INFO - Error in PyTorch training batch 3: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,126 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,127 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,142 - INFO - Error in PyTorch training batch 4: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,142 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,143 - INFO - PyTorch batch 5
2025-04-11 22:14:36,143 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,144 - INFO - Input shape after fixing: torch.Size([16, 3, 128, 128])
2025-04-11 22:14:36,144 - INFO - Target shape: torch.Size([4, 4])
2025-04-11 22:14:36,158 - INFO - Error in PyTorch training batch 5: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,159 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,160 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,174 - INFO - Error in PyTorch training batch 6: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,175 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,176 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,189 - INFO - Error in PyTorch training batch 7: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,190 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,191 - INFO - Fixing input shape: torch.Size([2, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,213 - INFO - Error in PyTorch training batch 8: Expected input batch_size (8) to match target batch_size (2).
2025-04-11 22:14:36,213 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (8) to match target batch_size (2).

2025-04-11 22:14:36,216 - INFO - Validation tensors - inputs: torch.Size([4, 4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:14:36,216 - INFO - Validation tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:14:36,216 - INFO - Error in PyTorch validation batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:14:36,217 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:14:36,219 - INFO - Error in PyTorch validation batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:14:36,220 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:14:36,221 - INFO - Error in PyTorch validation batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]
2025-04-11 22:14:36,221 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]

2025-04-11 22:14:36,222 - INFO - PyTorch Direct - Epoch 2/2
2025-04-11 22:14:36,223 - INFO - PyTorch batch 0
2025-04-11 22:14:36,223 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,223 - INFO - Input shape after fixing: torch.Size([16, 3, 128, 128])
2025-04-11 22:14:36,223 - INFO - Target shape: torch.Size([4, 4])
2025-04-11 22:14:36,227 - INFO - Training tensors - inputs: torch.Size([16, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:14:36,227 - INFO - Training tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:14:36,227 - INFO - Training tensors - outputs: torch.Size([16, 5]), dtype: torch.float32
2025-04-11 22:14:36,228 - INFO - Error in PyTorch training batch 0: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,228 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,229 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,243 - INFO - Error in PyTorch training batch 1: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,243 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,244 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,258 - INFO - Error in PyTorch training batch 2: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,259 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,260 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,273 - INFO - Error in PyTorch training batch 3: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,274 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,275 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,288 - INFO - Error in PyTorch training batch 4: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,289 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,291 - INFO - PyTorch batch 5
2025-04-11 22:14:36,292 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,292 - INFO - Input shape after fixing: torch.Size([16, 3, 128, 128])
2025-04-11 22:14:36,292 - INFO - Target shape: torch.Size([4, 4])
2025-04-11 22:14:36,304 - INFO - Error in PyTorch training batch 5: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,304 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,306 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,319 - INFO - Error in PyTorch training batch 6: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,320 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,322 - INFO - Fixing input shape: torch.Size([4, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,334 - INFO - Error in PyTorch training batch 7: Expected input batch_size (16) to match target batch_size (4).
2025-04-11 22:14:36,335 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (16) to match target batch_size (4).

2025-04-11 22:14:36,337 - INFO - Fixing input shape: torch.Size([2, 4, 3, 128, 128]) -> 4D tensor
2025-04-11 22:14:36,349 - INFO - Error in PyTorch training batch 8: Expected input batch_size (8) to match target batch_size (2).
2025-04-11 22:14:36,350 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 607, in train_model
    loss = criterion(outputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Expected input batch_size (8) to match target batch_size (2).

2025-04-11 22:14:36,356 - INFO - Validation tensors - inputs: torch.Size([4, 4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:14:36,356 - INFO - Validation tensors - targets: torch.Size([4, 4]), dtype: torch.int64
2025-04-11 22:14:36,356 - INFO - Error in PyTorch validation batch 0: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:14:36,357 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:14:36,360 - INFO - Error in PyTorch validation batch 1: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]
2025-04-11 22:14:36,361 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [4, 4, 3, 128, 128]

2025-04-11 22:14:36,363 - INFO - Error in PyTorch validation batch 2: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]
2025-04-11 22:14:36,364 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 652, in train_model
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 3, 3, 128, 128]

2025-04-11 22:14:36,593 - INFO - Saved pure PyTorch model to models/pure_pytorch_model.pth
2025-04-11 22:14:36,594 - INFO - Created standalone prediction script: pytorch_predict.py
2025-04-11 22:14:36,595 - INFO - Saved vocabulary to models/vocab.pkl
2025-04-11 22:14:36,596 - INFO - Total processing time: 3.94s
2025-04-11 22:14:36,596 - INFO - ==================================================
2025-04-11 22:14:36,596 - INFO - Training completed successfully
2025-04-11 22:14:36,596 - INFO - ==================================================
2025-04-11 22:16:36,468 - INFO - ==================================================
2025-04-11 22:16:36,468 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:16:36,468 - INFO - ==================================================
2025-04-11 22:16:36,468 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:16:36,468 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:16:36,468 - INFO - FastAI version: 2.7.19
2025-04-11 22:16:36,486 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:16:36,486 - INFO - CUDA version: 12.4
2025-04-11 22:16:36,486 - INFO - Using device: cuda
2025-04-11 22:16:36,486 - INFO - Loading identity data...
2025-04-11 22:16:36,626 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:16:38,892 - INFO - Filtered out 1 missing images
2025-04-11 22:16:38,927 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:16:38,962 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:16:38,963 - INFO - Min images per class: 34
2025-04-11 22:16:38,963 - INFO - Max images per class: 35
2025-04-11 22:16:38,963 - INFO - Avg images per class: 34.6
2025-04-11 22:16:38,969 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:16:38,969 - INFO - Data loading completed in 2.48s
2025-04-11 22:16:38,970 - INFO - Creating databunch...
2025-04-11 22:16:38,971 - INFO - Training set: 138 images
2025-04-11 22:16:38,971 - INFO - Validation set: 35 images
2025-04-11 22:16:39,193 - INFO - Created databunch in 0.22s
2025-04-11 22:16:39,193 - INFO - Checking dataloaders...
2025-04-11 22:16:39,202 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:16:39,203 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:16:39,203 - INFO - Classes: 5 unique classes
2025-04-11 22:16:39,203 - INFO - Data device: cuda:0
2025-04-11 22:16:39,211 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:16:39,220 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:16:39,228 - INFO - Dataloader validation successful
2025-04-11 22:16:39,228 - INFO - DataLoaders creation completed in 2.74s
2025-04-11 22:16:39,228 - INFO - Starting model training...
2025-04-11 22:16:39,228 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:16:39,228 - INFO - ========================================
2025-04-11 22:16:39,228 - INFO - USING PURE PYTORCH TRAINING
2025-04-11 22:16:39,229 - INFO - ========================================
2025-04-11 22:16:39,229 - INFO - Creating pure PyTorch datasets...
2025-04-11 22:16:39,229 - INFO - Extracting image paths and labels directly...
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Extracted 0 items from dataset items
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,229 - INFO - Unknown item structure: <class 'str'>
2025-04-11 22:16:39,230 - INFO - Extracted 0 items from dataset items
2025-04-11 22:16:39,230 - INFO - Successfully extracted 0 training and 0 validation image paths
2025-04-11 22:16:39,230 - INFO - Error creating pure PyTorch datasets: num_samples should be a positive integer value, but got num_samples=0
2025-04-11 22:16:39,232 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/simpler_train.py", line 521, in create_pure_pytorch_datasets
    train_loader = DataLoader(
                   ^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 383, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/torch/utils/data/sampler.py", line 165, in __init__
    raise ValueError(
ValueError: num_samples should be a positive integer value, but got num_samples=0

2025-04-11 22:16:39,233 - INFO - Falling back to direct dataloader conversion...
2025-04-11 22:16:39,233 - INFO - Creating direct dataloader that yields standard PyTorch tensors...
2025-04-11 22:16:39,400 - INFO - Model will classify 5 classes
2025-04-11 22:16:39,411 - INFO - PyTorch Direct - Epoch 1/2
2025-04-11 22:16:39,421 - INFO - PyTorch batch 0
2025-04-11 22:16:39,421 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:39,422 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:39,555 - INFO - Training tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:16:39,555 - INFO - Training tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:16:39,555 - INFO - Training tensors - outputs: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:16:39,701 - INFO - Batch 0 - Loss: 2.1723
2025-04-11 22:16:39,877 - INFO - PyTorch batch 5
2025-04-11 22:16:39,877 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:39,877 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,075 - INFO - PyTorch batch 10
2025-04-11 22:16:40,075 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:40,075 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,106 - INFO - Batch 10 - Loss: 1.4157
2025-04-11 22:16:40,270 - INFO - PyTorch batch 15
2025-04-11 22:16:40,271 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:40,271 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,466 - INFO - PyTorch batch 20
2025-04-11 22:16:40,467 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:40,467 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,498 - INFO - Batch 20 - Loss: 0.8352
2025-04-11 22:16:40,662 - INFO - PyTorch batch 25
2025-04-11 22:16:40,663 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:40,663 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,857 - INFO - PyTorch batch 30
2025-04-11 22:16:40,858 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:40,858 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:40,889 - INFO - Batch 30 - Loss: 1.0610
2025-04-11 22:16:41,018 - INFO - Validation tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:16:41,018 - INFO - Validation tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:16:41,139 - INFO - Epoch 1 - Train Loss: 1.1961
2025-04-11 22:16:41,139 - INFO - Epoch 1 - Val Loss: 0.5622, Accuracy: 0.8286
2025-04-11 22:16:41,139 - INFO - PyTorch Direct - Epoch 2/2
2025-04-11 22:16:41,147 - INFO - PyTorch batch 0
2025-04-11 22:16:41,148 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:41,148 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:41,152 - INFO - Training tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:16:41,152 - INFO - Training tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:16:41,152 - INFO - Training tensors - outputs: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:16:41,179 - INFO - Batch 0 - Loss: 0.6067
2025-04-11 22:16:41,344 - INFO - PyTorch batch 5
2025-04-11 22:16:41,344 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:41,344 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:41,539 - INFO - PyTorch batch 10
2025-04-11 22:16:41,540 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:41,540 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:41,570 - INFO - Batch 10 - Loss: 0.3940
2025-04-11 22:16:41,735 - INFO - PyTorch batch 15
2025-04-11 22:16:41,736 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:41,736 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:41,930 - INFO - PyTorch batch 20
2025-04-11 22:16:41,931 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:41,931 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:41,962 - INFO - Batch 20 - Loss: 0.2475
2025-04-11 22:16:42,126 - INFO - PyTorch batch 25
2025-04-11 22:16:42,127 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:42,127 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:42,322 - INFO - PyTorch batch 30
2025-04-11 22:16:42,323 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:16:42,323 - INFO - Target shape: torch.Size([4])
2025-04-11 22:16:42,354 - INFO - Batch 30 - Loss: 0.2807
2025-04-11 22:16:42,484 - INFO - Validation tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:16:42,484 - INFO - Validation tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:16:42,598 - INFO - Epoch 2 - Train Loss: 0.5929
2025-04-11 22:16:42,598 - INFO - Epoch 2 - Val Loss: 0.5128, Accuracy: 0.8286
2025-04-11 22:16:42,837 - INFO - Saved pure PyTorch model to models/pure_pytorch_model.pth
2025-04-11 22:16:42,837 - INFO - Created standalone prediction script: pytorch_predict.py
2025-04-11 22:16:42,838 - INFO - Saved vocabulary to models/vocab.pkl
2025-04-11 22:16:42,839 - INFO - Total processing time: 6.35s
2025-04-11 22:16:42,839 - INFO - ==================================================
2025-04-11 22:16:42,839 - INFO - Training completed successfully
2025-04-11 22:16:42,839 - INFO - ==================================================
2025-04-11 22:19:22,417 - INFO - ==================================================
2025-04-11 22:19:22,417 - INFO - Starting simplified celebrity recognition training
2025-04-11 22:19:22,417 - INFO - ==================================================
2025-04-11 22:19:22,417 - INFO - Python version: 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]
2025-04-11 22:19:22,417 - INFO - PyTorch version: 2.6.0+cu124
2025-04-11 22:19:22,418 - INFO - FastAI version: 2.7.19
2025-04-11 22:19:22,435 - INFO - CUDA available: NVIDIA GeForce GTX 1050 Ti
2025-04-11 22:19:22,435 - INFO - CUDA version: 12.4
2025-04-11 22:19:22,435 - INFO - Using device: cuda
2025-04-11 22:19:22,435 - INFO - Loading identity data...
2025-04-11 22:19:22,576 - INFO - Loaded 202600 raw image identity records in 0.14s
2025-04-11 22:19:24,865 - INFO - Filtered out 1 missing images
2025-04-11 22:19:24,900 - INFO - After filtering for min 20 images: 163749 images of 6348 celebrities
2025-04-11 22:19:24,936 - INFO - Limited to top 5 celebrities: 173 images
2025-04-11 22:19:24,936 - INFO - Min images per class: 34
2025-04-11 22:19:24,936 - INFO - Max images per class: 35
2025-04-11 22:19:24,937 - INFO - Avg images per class: 34.6
2025-04-11 22:19:24,950 - INFO - Saved 15 sample images to sample_images/
2025-04-11 22:19:24,951 - INFO - Data loading completed in 2.52s
2025-04-11 22:19:24,951 - INFO - Creating databunch...
2025-04-11 22:19:24,954 - INFO - Training set: 138 images
2025-04-11 22:19:24,954 - INFO - Validation set: 35 images
2025-04-11 22:19:25,196 - INFO - Created databunch in 0.25s
2025-04-11 22:19:25,196 - INFO - Checking dataloaders...
2025-04-11 22:19:25,206 - INFO - Successfully retrieved a batch of shape torch.Size([4, 3, 128, 128])
2025-04-11 22:19:25,206 - INFO - Labels shape: torch.Size([4])
2025-04-11 22:19:25,206 - INFO - Classes: 5 unique classes
2025-04-11 22:19:25,206 - INFO - Data device: cuda:0
2025-04-11 22:19:25,214 - INFO - Batch 0: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:19:25,223 - INFO - Batch 1: torch.Size([4, 3, 128, 128]), torch.Size([4]), device: cuda:0
2025-04-11 22:19:25,231 - INFO - Dataloader validation successful
2025-04-11 22:19:25,231 - INFO - DataLoaders creation completed in 2.80s
2025-04-11 22:19:25,231 - INFO - Starting model training...
2025-04-11 22:19:25,231 - INFO - GPU Memory: 0.00MB allocated, 6.00MB cached
2025-04-11 22:19:25,231 - INFO - ========================================
2025-04-11 22:19:25,231 - INFO - USING PURE PYTORCH TRAINING
2025-04-11 22:19:25,232 - INFO - ========================================
2025-04-11 22:19:25,232 - INFO - Creating pure PyTorch datasets directly from data directory...
2025-04-11 22:19:25,232 - INFO - Loading identity data for direct dataset creation...
2025-04-11 22:19:26,990 - INFO - Found 202599 images with existing paths
2025-04-11 22:19:26,990 - INFO - Using vocabulary with 5 classes
2025-04-11 22:19:27,005 - INFO - After filtering to classes in vocabulary: 173 images
2025-04-11 22:19:27,007 - INFO - After applying all filters: 173 images, 5 classes
2025-04-11 22:19:27,008 - INFO - Training set: 138 images
2025-04-11 22:19:27,008 - INFO - Validation set: 35 images
2025-04-11 22:19:27,009 - INFO - Created datasets with 138 training and 35 validation samples
2025-04-11 22:19:27,172 - INFO - Model will classify 5 classes
2025-04-11 22:19:27,183 - INFO - PyTorch Direct - Epoch 1/2
2025-04-11 22:19:27,187 - INFO - PyTorch batch 0
2025-04-11 22:19:27,188 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:27,188 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:27,323 - INFO - Training tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:19:27,323 - INFO - Training tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:19:27,323 - INFO - Training tensors - outputs: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:19:27,469 - INFO - Batch 0 - Loss: 1.2862
2025-04-11 22:19:27,626 - INFO - PyTorch batch 5
2025-04-11 22:19:27,626 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:27,626 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:27,809 - INFO - PyTorch batch 10
2025-04-11 22:19:27,809 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:27,809 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:27,841 - INFO - Batch 10 - Loss: 1.3625
2025-04-11 22:19:27,987 - INFO - PyTorch batch 15
2025-04-11 22:19:27,987 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:27,987 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:28,160 - INFO - PyTorch batch 20
2025-04-11 22:19:28,161 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:28,161 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:28,192 - INFO - Batch 20 - Loss: 0.9326
2025-04-11 22:19:28,335 - INFO - PyTorch batch 25
2025-04-11 22:19:28,335 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:28,335 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:28,509 - INFO - PyTorch batch 30
2025-04-11 22:19:28,509 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:28,509 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:28,540 - INFO - Batch 30 - Loss: 0.8382
2025-04-11 22:19:28,680 - INFO - Validation tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:19:28,680 - INFO - Validation tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:19:28,764 - INFO - Epoch 1 - Train Loss: 1.1912
2025-04-11 22:19:28,764 - INFO - Epoch 1 - Val Loss: 0.7112, Accuracy: 0.7143
2025-04-11 22:19:28,765 - INFO - PyTorch Direct - Epoch 2/2
2025-04-11 22:19:28,769 - INFO - PyTorch batch 0
2025-04-11 22:19:28,770 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:28,770 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:28,773 - INFO - Training tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:19:28,774 - INFO - Training tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:19:28,774 - INFO - Training tensors - outputs: torch.Size([4, 5]), dtype: torch.float32
2025-04-11 22:19:28,801 - INFO - Batch 0 - Loss: 0.2270
2025-04-11 22:19:28,947 - INFO - PyTorch batch 5
2025-04-11 22:19:28,948 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:28,948 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,121 - INFO - PyTorch batch 10
2025-04-11 22:19:29,122 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:29,122 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,153 - INFO - Batch 10 - Loss: 0.1850
2025-04-11 22:19:29,296 - INFO - PyTorch batch 15
2025-04-11 22:19:29,296 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:29,296 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,469 - INFO - PyTorch batch 20
2025-04-11 22:19:29,470 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:29,470 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,501 - INFO - Batch 20 - Loss: 0.2314
2025-04-11 22:19:29,643 - INFO - PyTorch batch 25
2025-04-11 22:19:29,644 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:29,644 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,817 - INFO - PyTorch batch 30
2025-04-11 22:19:29,818 - INFO - Input shape after fixing: torch.Size([4, 3, 128, 128])
2025-04-11 22:19:29,818 - INFO - Target shape: torch.Size([4])
2025-04-11 22:19:29,848 - INFO - Batch 30 - Loss: 0.8222
2025-04-11 22:19:29,982 - INFO - Validation tensors - inputs: torch.Size([4, 3, 128, 128]), dtype: torch.float32
2025-04-11 22:19:29,982 - INFO - Validation tensors - targets: torch.Size([4]), dtype: torch.int64
2025-04-11 22:19:30,061 - INFO - Epoch 2 - Train Loss: 0.3592
2025-04-11 22:19:30,061 - INFO - Epoch 2 - Val Loss: 0.5473, Accuracy: 0.8571
2025-04-11 22:19:30,320 - INFO - Saved pure PyTorch model to models/pure_pytorch_model.pth
2025-04-11 22:19:30,320 - INFO - Created standalone prediction script: pytorch_predict.py
2025-04-11 22:19:30,321 - INFO - Saved vocabulary to models/vocab.pkl
2025-04-11 22:19:30,322 - INFO - Total processing time: 7.89s
2025-04-11 22:19:30,322 - INFO - ==================================================
2025-04-11 22:19:30,323 - INFO - Training completed successfully
2025-04-11 22:19:30,323 - INFO - ==================================================
2025-04-12 08:29:41,812 - INFO - Starting celebrity recognition training pipeline
2025-04-12 08:29:41,812 - INFO - GPU Memory: 0.00MB allocated, 0.00MB cached
2025-04-12 08:29:41,813 - INFO - Loading identity data...
2025-04-12 08:29:41,969 - INFO - Loaded 202600 image identity records
2025-04-12 08:29:44,268 - INFO - Filtered out 1 missing images
2025-04-12 08:29:44,310 - INFO - After minimum image filtering: 70838 images of 2360 celebrities
2025-04-12 08:29:44,329 - INFO - Limited to top 30 celebrities (938 images)
2025-04-12 08:29:44,330 - INFO - Class distribution - Min: 30, Max: 35, Avg: 31.3 images per celebrity
2025-04-12 08:29:44,330 - INFO - Creating pure PyTorch datasets...
2025-04-12 08:29:44,333 - INFO - Training set: 797 images
2025-04-12 08:29:44,333 - INFO - Validation set: 141 images
2025-04-12 08:29:44,334 - INFO - Created datasets with 797 training and 141 validation samples
2025-04-12 08:29:44,336 - INFO - Created data loaders with 30 classes
2025-04-12 08:29:44,336 - INFO - Creating pure PyTorch datasets...
2025-04-12 08:29:44,338 - INFO - Training set: 797 images
2025-04-12 08:29:44,338 - INFO - Validation set: 141 images
2025-04-12 08:29:44,340 - INFO - Created datasets with 797 training and 141 validation samples
2025-04-12 08:29:44,341 - INFO - Created secondary data loaders with image size 320
2025-04-12 08:29:44,341 - INFO - Using pure PyTorch implementation for training
2025-04-12 08:29:44,341 - INFO - Creating PyTorch model with convnext_small architecture
2025-04-12 08:30:31,803 - INFO - Model created and moved to cuda
2025-04-12 08:30:31,803 - INFO - Training PyTorch model for 3 epochs with learning rate 0.0005
2025-04-12 08:30:31,805 - INFO - GPU Memory: 189.63MB allocated, 208.00MB cached
2025-04-12 08:30:31,805 - INFO - Using weighted loss function
2025-04-12 08:30:31,808 - INFO - Epoch 1/3
2025-04-12 08:31:01,525 - INFO - Batch 20/100 - Loss: 3.3438
2025-04-12 08:31:01,526 - INFO - GPU Memory: 817.01MB allocated, 2584.00MB cached
2025-04-12 08:31:28,394 - INFO - Batch 40/100 - Loss: 3.4897
2025-04-12 08:31:28,394 - INFO - GPU Memory: 817.01MB allocated, 2584.00MB cached
2025-04-12 08:31:55,282 - INFO - Batch 60/100 - Loss: 3.4390
2025-04-12 08:31:55,282 - INFO - GPU Memory: 817.01MB allocated, 2584.00MB cached
2025-04-12 08:32:22,223 - INFO - Batch 80/100 - Loss: 3.3984
2025-04-12 08:32:22,223 - INFO - GPU Memory: 817.01MB allocated, 2584.00MB cached
2025-04-12 08:32:48,783 - INFO - Batch 100/100 - Loss: 3.3170
2025-04-12 08:32:48,783 - INFO - GPU Memory: 816.01MB allocated, 2586.00MB cached
2025-04-12 08:32:52,817 - INFO - Epoch 1 results:
2025-04-12 08:32:52,817 - INFO - Train Loss: 3.4610, Train Acc: 0.0326
2025-04-12 08:32:52,817 - INFO - Val Loss: 3.3644, Val Acc: 0.0355, Top-3 Acc: 0.1348
2025-04-12 08:32:52,817 - INFO - Epoch time: 141.01s
2025-04-12 08:32:53,016 - INFO - Saved new best model with accuracy 0.0355
2025-04-12 08:32:53,209 - INFO - Saved latest model for epoch 1
2025-04-12 08:32:53,209 - INFO - Epoch 2/3
2025-04-12 08:33:20,308 - INFO - Batch 20/100 - Loss: 3.3064
2025-04-12 08:33:20,309 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:33:47,296 - INFO - Batch 40/100 - Loss: 3.3275
2025-04-12 08:33:47,297 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:34:14,264 - INFO - Batch 60/100 - Loss: 3.2954
2025-04-12 08:34:14,264 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:34:41,243 - INFO - Batch 80/100 - Loss: 3.4011
2025-04-12 08:34:41,244 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:35:07,768 - INFO - Batch 100/100 - Loss: 3.3894
2025-04-12 08:35:07,769 - INFO - GPU Memory: 816.01MB allocated, 2586.00MB cached
2025-04-12 08:35:11,624 - INFO - Epoch 2 results:
2025-04-12 08:35:11,625 - INFO - Train Loss: 3.4387, Train Acc: 0.0263
2025-04-12 08:35:11,625 - INFO - Val Loss: 3.3783, Val Acc: 0.0426, Top-3 Acc: 0.1348
2025-04-12 08:35:11,625 - INFO - Epoch time: 138.42s
2025-04-12 08:35:12,687 - INFO - Saved new best model with accuracy 0.0426
2025-04-12 08:35:12,921 - INFO - Saved latest model for epoch 2
2025-04-12 08:35:12,921 - INFO - Epoch 3/3
2025-04-12 08:35:40,039 - INFO - Batch 20/100 - Loss: 3.2843
2025-04-12 08:35:40,039 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:36:07,052 - INFO - Batch 40/100 - Loss: 3.4461
2025-04-12 08:36:07,052 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:36:34,103 - INFO - Batch 60/100 - Loss: 3.3306
2025-04-12 08:36:34,103 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:37:01,119 - INFO - Batch 80/100 - Loss: 3.3760
2025-04-12 08:37:01,120 - INFO - GPU Memory: 817.01MB allocated, 2586.00MB cached
2025-04-12 08:37:27,696 - INFO - Batch 100/100 - Loss: 3.4501
2025-04-12 08:37:27,697 - INFO - GPU Memory: 816.01MB allocated, 2586.00MB cached
2025-04-12 08:37:31,554 - INFO - Epoch 3 results:
2025-04-12 08:37:31,554 - INFO - Train Loss: 3.3590, Train Acc: 0.0389
2025-04-12 08:37:31,554 - INFO - Val Loss: 3.2206, Val Acc: 0.0426, Top-3 Acc: 0.1986
2025-04-12 08:37:31,554 - INFO - Epoch time: 138.63s
2025-04-12 08:37:31,750 - INFO - Saved latest model for epoch 3
2025-04-12 08:37:31,751 - INFO - Training completed in 419.94s
2025-04-12 08:37:31,751 - INFO - Best validation accuracy: 0.0426
2025-04-12 08:37:31,858 - INFO - Fine-tuning with larger image size 320
2025-04-12 08:37:31,859 - INFO - Training PyTorch model for 15 epochs with learning rate 5e-05
2025-04-12 08:37:31,859 - INFO - GPU Memory: 417.00MB allocated, 2586.00MB cached
2025-04-12 08:37:31,859 - INFO - Using weighted loss function
2025-04-12 08:37:31,860 - INFO - Epoch 1/15
2025-04-12 08:38:15,128 - INFO - Batch 20/100 - Loss: 3.3005
2025-04-12 08:38:15,129 - INFO - GPU Memory: 818.19MB allocated, 3726.00MB cached
2025-04-12 08:38:58,311 - INFO - Batch 40/100 - Loss: 3.3420
2025-04-12 08:38:58,312 - INFO - GPU Memory: 818.19MB allocated, 3726.00MB cached
2025-04-12 08:39:41,478 - INFO - Batch 60/100 - Loss: 3.3417
2025-04-12 08:39:41,479 - INFO - GPU Memory: 818.19MB allocated, 3726.00MB cached
2025-04-12 08:40:24,656 - INFO - Batch 80/100 - Loss: 3.3774
2025-04-12 08:40:24,656 - INFO - GPU Memory: 818.19MB allocated, 3726.00MB cached
2025-04-12 08:41:07,012 - INFO - Batch 100/100 - Loss: 3.4212
2025-04-12 08:41:07,013 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:41:13,035 - INFO - Epoch 1 results:
2025-04-12 08:41:13,035 - INFO - Train Loss: 3.3711, Train Acc: 0.0402
2025-04-12 08:41:13,035 - INFO - Val Loss: 3.1812, Val Acc: 0.0709, Top-3 Acc: 0.1915
2025-04-12 08:41:13,036 - INFO - Epoch time: 221.18s
2025-04-12 08:41:14,050 - INFO - Saved new best model with accuracy 0.0709
2025-04-12 08:41:15,097 - INFO - Saved latest model for epoch 1
2025-04-12 08:41:15,098 - INFO - Epoch 2/15
2025-04-12 08:41:58,383 - INFO - Batch 20/100 - Loss: 3.2474
2025-04-12 08:41:58,384 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:42:41,522 - INFO - Batch 40/100 - Loss: 3.4593
2025-04-12 08:42:41,522 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:43:24,646 - INFO - Batch 60/100 - Loss: 3.2518
2025-04-12 08:43:24,647 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:44:07,772 - INFO - Batch 80/100 - Loss: 3.4048
2025-04-12 08:44:07,773 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:44:50,182 - INFO - Batch 100/100 - Loss: 3.2585
2025-04-12 08:44:50,183 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:44:56,208 - INFO - Epoch 2 results:
2025-04-12 08:44:56,209 - INFO - Train Loss: 3.1588, Train Acc: 0.0816
2025-04-12 08:44:56,209 - INFO - Val Loss: 2.9677, Val Acc: 0.1135, Top-3 Acc: 0.2908
2025-04-12 08:44:56,209 - INFO - Epoch time: 221.11s
2025-04-12 08:44:57,293 - INFO - Saved new best model with accuracy 0.1135
2025-04-12 08:44:58,328 - INFO - Saved latest model for epoch 2
2025-04-12 08:44:58,329 - INFO - Epoch 3/15
2025-04-12 08:45:41,659 - INFO - Batch 20/100 - Loss: 3.2518
2025-04-12 08:45:41,660 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:46:24,874 - INFO - Batch 40/100 - Loss: 2.8900
2025-04-12 08:46:24,875 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:47:07,990 - INFO - Batch 60/100 - Loss: 2.6980
2025-04-12 08:47:07,991 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:47:51,170 - INFO - Batch 80/100 - Loss: 2.9372
2025-04-12 08:47:51,170 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:48:33,585 - INFO - Batch 100/100 - Loss: 3.3367
2025-04-12 08:48:33,586 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:48:39,658 - INFO - Epoch 3 results:
2025-04-12 08:48:39,658 - INFO - Train Loss: 2.8957, Train Acc: 0.1317
2025-04-12 08:48:39,658 - INFO - Val Loss: 2.7356, Val Acc: 0.1773, Top-3 Acc: 0.3830
2025-04-12 08:48:39,658 - INFO - Epoch time: 221.33s
2025-04-12 08:48:40,547 - INFO - Saved new best model with accuracy 0.1773
2025-04-12 08:48:41,597 - INFO - Saved latest model for epoch 3
2025-04-12 08:48:41,598 - INFO - Epoch 4/15
2025-04-12 08:49:24,940 - INFO - Batch 20/100 - Loss: 3.0012
2025-04-12 08:49:24,940 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:50:08,055 - INFO - Batch 40/100 - Loss: 2.6305
2025-04-12 08:50:08,056 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:50:51,296 - INFO - Batch 60/100 - Loss: 3.0163
2025-04-12 08:50:51,297 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:51:34,440 - INFO - Batch 80/100 - Loss: 2.6551
2025-04-12 08:51:34,441 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:52:16,804 - INFO - Batch 100/100 - Loss: 2.1527
2025-04-12 08:52:16,805 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:52:22,824 - INFO - Epoch 4 results:
2025-04-12 08:52:22,824 - INFO - Train Loss: 2.5414, Train Acc: 0.2422
2025-04-12 08:52:22,824 - INFO - Val Loss: 2.4455, Val Acc: 0.2411, Top-3 Acc: 0.4823
2025-04-12 08:52:22,824 - INFO - Epoch time: 221.23s
2025-04-12 08:52:23,939 - INFO - Saved new best model with accuracy 0.2411
2025-04-12 08:52:24,163 - INFO - Saved latest model for epoch 4
2025-04-12 08:52:24,163 - INFO - Epoch 5/15
2025-04-12 08:53:07,472 - INFO - Batch 20/100 - Loss: 2.0049
2025-04-12 08:53:07,473 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:53:50,667 - INFO - Batch 40/100 - Loss: 2.3946
2025-04-12 08:53:50,668 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:54:33,783 - INFO - Batch 60/100 - Loss: 1.6725
2025-04-12 08:54:33,783 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:55:16,895 - INFO - Batch 80/100 - Loss: 2.0038
2025-04-12 08:55:16,895 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:55:59,226 - INFO - Batch 100/100 - Loss: 1.7701
2025-04-12 08:55:59,227 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:56:05,287 - INFO - Epoch 5 results:
2025-04-12 08:56:05,287 - INFO - Train Loss: 2.1504, Train Acc: 0.3501
2025-04-12 08:56:05,287 - INFO - Val Loss: 2.1493, Val Acc: 0.3688, Top-3 Acc: 0.5532
2025-04-12 08:56:05,287 - INFO - Epoch time: 221.12s
2025-04-12 08:56:06,351 - INFO - Saved new best model with accuracy 0.3688
2025-04-12 08:56:06,569 - INFO - Saved latest model for epoch 5
2025-04-12 08:56:06,569 - INFO - Epoch 6/15
2025-04-12 08:56:49,856 - INFO - Batch 20/100 - Loss: 1.7597
2025-04-12 08:56:49,857 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:57:33,035 - INFO - Batch 40/100 - Loss: 1.6687
2025-04-12 08:57:33,035 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:58:16,222 - INFO - Batch 60/100 - Loss: 1.9544
2025-04-12 08:58:16,223 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:58:59,466 - INFO - Batch 80/100 - Loss: 2.5403
2025-04-12 08:58:59,467 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 08:59:41,759 - INFO - Batch 100/100 - Loss: 1.4224
2025-04-12 08:59:41,760 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 08:59:47,818 - INFO - Epoch 6 results:
2025-04-12 08:59:47,819 - INFO - Train Loss: 1.7455, Train Acc: 0.4856
2025-04-12 08:59:47,819 - INFO - Val Loss: 1.8477, Val Acc: 0.4397, Top-3 Acc: 0.6667
2025-04-12 08:59:47,819 - INFO - Epoch time: 221.25s
2025-04-12 08:59:48,910 - INFO - Saved new best model with accuracy 0.4397
2025-04-12 08:59:49,107 - INFO - Saved latest model for epoch 6
2025-04-12 08:59:49,107 - INFO - Epoch 7/15
2025-04-12 09:00:32,367 - INFO - Batch 20/100 - Loss: 1.3856
2025-04-12 09:00:32,368 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:01:15,580 - INFO - Batch 40/100 - Loss: 1.2662
2025-04-12 09:01:15,581 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:01:58,762 - INFO - Batch 60/100 - Loss: 1.8266
2025-04-12 09:01:58,763 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:02:41,982 - INFO - Batch 80/100 - Loss: 1.8858
2025-04-12 09:02:41,982 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:03:24,374 - INFO - Batch 100/100 - Loss: 1.4543
2025-04-12 09:03:24,375 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:03:30,415 - INFO - Epoch 7 results:
2025-04-12 09:03:30,415 - INFO - Train Loss: 1.3247, Train Acc: 0.6136
2025-04-12 09:03:30,416 - INFO - Val Loss: 1.5383, Val Acc: 0.4965, Top-3 Acc: 0.7660
2025-04-12 09:03:30,416 - INFO - Epoch time: 221.31s
2025-04-12 09:03:31,546 - INFO - Saved new best model with accuracy 0.4965
2025-04-12 09:03:31,765 - INFO - Saved latest model for epoch 7
2025-04-12 09:03:31,765 - INFO - Epoch 8/15
2025-04-12 09:04:15,122 - INFO - Batch 20/100 - Loss: 0.8469
2025-04-12 09:04:15,123 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:04:58,321 - INFO - Batch 40/100 - Loss: 0.8894
2025-04-12 09:04:58,322 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:05:41,498 - INFO - Batch 60/100 - Loss: 0.6848
2025-04-12 09:05:41,499 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:06:24,634 - INFO - Batch 80/100 - Loss: 1.6783
2025-04-12 09:06:24,635 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:07:07,029 - INFO - Batch 100/100 - Loss: 0.7624
2025-04-12 09:07:07,029 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:07:13,078 - INFO - Epoch 8 results:
2025-04-12 09:07:13,078 - INFO - Train Loss: 0.9868, Train Acc: 0.7465
2025-04-12 09:07:13,078 - INFO - Val Loss: 1.4172, Val Acc: 0.5603, Top-3 Acc: 0.7943
2025-04-12 09:07:13,078 - INFO - Epoch time: 221.31s
2025-04-12 09:07:14,085 - INFO - Saved new best model with accuracy 0.5603
2025-04-12 09:07:14,306 - INFO - Saved latest model for epoch 8
2025-04-12 09:07:14,306 - INFO - Epoch 9/15
2025-04-12 09:07:57,760 - INFO - Batch 20/100 - Loss: 0.6066
2025-04-12 09:07:57,761 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:08:41,028 - INFO - Batch 40/100 - Loss: 0.9338
2025-04-12 09:08:41,028 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:09:24,321 - INFO - Batch 60/100 - Loss: 0.4233
2025-04-12 09:09:24,322 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:10:07,641 - INFO - Batch 80/100 - Loss: 1.1670
2025-04-12 09:10:07,642 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:10:50,102 - INFO - Batch 100/100 - Loss: 0.6180
2025-04-12 09:10:50,102 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:10:56,130 - INFO - Epoch 9 results:
2025-04-12 09:10:56,130 - INFO - Train Loss: 0.7017, Train Acc: 0.8482
2025-04-12 09:10:56,130 - INFO - Val Loss: 1.1856, Val Acc: 0.6525, Top-3 Acc: 0.8369
2025-04-12 09:10:56,131 - INFO - Epoch time: 221.82s
2025-04-12 09:10:57,117 - INFO - Saved new best model with accuracy 0.6525
2025-04-12 09:10:57,335 - INFO - Saved latest model for epoch 9
2025-04-12 09:10:57,335 - INFO - Epoch 10/15
2025-04-12 09:11:40,787 - INFO - Batch 20/100 - Loss: 0.4601
2025-04-12 09:11:40,788 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:12:24,087 - INFO - Batch 40/100 - Loss: 0.3843
2025-04-12 09:12:24,088 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:13:07,426 - INFO - Batch 60/100 - Loss: 0.5407
2025-04-12 09:13:07,426 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:13:50,675 - INFO - Batch 80/100 - Loss: 0.5034
2025-04-12 09:13:50,675 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:14:33,134 - INFO - Batch 100/100 - Loss: 0.4615
2025-04-12 09:14:33,134 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:14:39,147 - INFO - Epoch 10 results:
2025-04-12 09:14:39,148 - INFO - Train Loss: 0.4706, Train Acc: 0.9021
2025-04-12 09:14:39,148 - INFO - Val Loss: 1.0006, Val Acc: 0.7234, Top-3 Acc: 0.8582
2025-04-12 09:14:39,148 - INFO - Epoch time: 221.81s
2025-04-12 09:14:40,126 - INFO - Saved new best model with accuracy 0.7234
2025-04-12 09:14:40,347 - INFO - Saved latest model for epoch 10
2025-04-12 09:14:40,347 - INFO - Epoch 11/15
2025-04-12 09:15:23,664 - INFO - Batch 20/100 - Loss: 0.2300
2025-04-12 09:15:23,665 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:16:06,824 - INFO - Batch 40/100 - Loss: 0.4376
2025-04-12 09:16:06,825 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:16:49,984 - INFO - Batch 60/100 - Loss: 0.2875
2025-04-12 09:16:49,985 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:17:33,198 - INFO - Batch 80/100 - Loss: 0.1844
2025-04-12 09:17:33,199 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:18:15,540 - INFO - Batch 100/100 - Loss: 0.3227
2025-04-12 09:18:15,541 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:18:21,601 - INFO - Epoch 11 results:
2025-04-12 09:18:21,601 - INFO - Train Loss: 0.2953, Train Acc: 0.9624
2025-04-12 09:18:21,602 - INFO - Val Loss: 1.0447, Val Acc: 0.6738, Top-3 Acc: 0.8440
2025-04-12 09:18:21,602 - INFO - Epoch time: 221.25s
2025-04-12 09:18:21,795 - INFO - Saved latest model for epoch 11
2025-04-12 09:18:21,796 - INFO - Epoch 12/15
2025-04-12 09:19:05,124 - INFO - Batch 20/100 - Loss: 0.1520
2025-04-12 09:19:05,125 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:19:48,333 - INFO - Batch 40/100 - Loss: 0.1462
2025-04-12 09:19:48,334 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:20:31,499 - INFO - Batch 60/100 - Loss: 0.1404
2025-04-12 09:20:31,500 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:21:14,716 - INFO - Batch 80/100 - Loss: 0.2180
2025-04-12 09:21:14,717 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:21:57,125 - INFO - Batch 100/100 - Loss: 0.0727
2025-04-12 09:21:57,125 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:22:03,190 - INFO - Epoch 12 results:
2025-04-12 09:22:03,190 - INFO - Train Loss: 0.2046, Train Acc: 0.9862
2025-04-12 09:22:03,190 - INFO - Val Loss: 0.8472, Val Acc: 0.7447, Top-3 Acc: 0.9149
2025-04-12 09:22:03,191 - INFO - Epoch time: 221.39s
2025-04-12 09:22:04,059 - INFO - Saved new best model with accuracy 0.7447
2025-04-12 09:22:04,277 - INFO - Saved latest model for epoch 12
2025-04-12 09:22:04,277 - INFO - Epoch 13/15
2025-04-12 09:22:47,767 - INFO - Batch 20/100 - Loss: 0.1370
2025-04-12 09:22:47,768 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:23:30,980 - INFO - Batch 40/100 - Loss: 0.2430
2025-04-12 09:23:30,981 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:24:14,251 - INFO - Batch 60/100 - Loss: 0.1248
2025-04-12 09:24:14,252 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:24:57,566 - INFO - Batch 80/100 - Loss: 0.1894
2025-04-12 09:24:57,566 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:25:40,029 - INFO - Batch 100/100 - Loss: 0.0427
2025-04-12 09:25:40,029 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:25:46,091 - INFO - Epoch 13 results:
2025-04-12 09:25:46,091 - INFO - Train Loss: 0.1242, Train Acc: 0.9937
2025-04-12 09:25:46,091 - INFO - Val Loss: 0.8184, Val Acc: 0.7518, Top-3 Acc: 0.9078
2025-04-12 09:25:46,091 - INFO - Epoch time: 221.81s
2025-04-12 09:25:46,953 - INFO - Saved new best model with accuracy 0.7518
2025-04-12 09:25:47,172 - INFO - Saved latest model for epoch 13
2025-04-12 09:25:47,172 - INFO - Epoch 14/15
2025-04-12 09:26:30,555 - INFO - Batch 20/100 - Loss: 0.0356
2025-04-12 09:26:30,556 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:27:13,904 - INFO - Batch 40/100 - Loss: 0.1016
2025-04-12 09:27:13,905 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:27:57,237 - INFO - Batch 60/100 - Loss: 0.1652
2025-04-12 09:27:57,237 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:28:40,507 - INFO - Batch 80/100 - Loss: 0.0302
2025-04-12 09:28:40,508 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:29:22,985 - INFO - Batch 100/100 - Loss: 0.0336
2025-04-12 09:29:22,985 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:29:29,040 - INFO - Epoch 14 results:
2025-04-12 09:29:29,040 - INFO - Train Loss: 0.0957, Train Acc: 0.9950
2025-04-12 09:29:29,040 - INFO - Val Loss: 0.7664, Val Acc: 0.7801, Top-3 Acc: 0.9149
2025-04-12 09:29:29,040 - INFO - Epoch time: 221.87s
2025-04-12 09:29:29,905 - INFO - Saved new best model with accuracy 0.7801
2025-04-12 09:29:30,122 - INFO - Saved latest model for epoch 14
2025-04-12 09:29:30,122 - INFO - Epoch 15/15
2025-04-12 09:30:13,511 - INFO - Batch 20/100 - Loss: 0.0327
2025-04-12 09:30:13,512 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:30:56,724 - INFO - Batch 40/100 - Loss: 0.1414
2025-04-12 09:30:56,724 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:31:39,932 - INFO - Batch 60/100 - Loss: 0.0401
2025-04-12 09:31:39,932 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:32:23,122 - INFO - Batch 80/100 - Loss: 0.0366
2025-04-12 09:32:23,122 - INFO - GPU Memory: 818.20MB allocated, 3726.00MB cached
2025-04-12 09:33:05,480 - INFO - Batch 100/100 - Loss: 0.0265
2025-04-12 09:33:05,480 - INFO - GPU Memory: 807.64MB allocated, 3726.00MB cached
2025-04-12 09:33:11,555 - INFO - Epoch 15 results:
2025-04-12 09:33:11,555 - INFO - Train Loss: 0.0684, Train Acc: 0.9962
2025-04-12 09:33:11,555 - INFO - Val Loss: 0.7147, Val Acc: 0.8014, Top-3 Acc: 0.9149
2025-04-12 09:33:11,556 - INFO - Epoch time: 221.43s
2025-04-12 09:33:12,552 - INFO - Saved new best model with accuracy 0.8014
2025-04-12 09:33:12,774 - INFO - Saved latest model for epoch 15
2025-04-12 09:33:12,775 - INFO - Training completed in 3340.91s
2025-04-12 09:33:12,775 - INFO - Best validation accuracy: 0.8014
2025-04-12 09:33:13,075 - INFO - Saved final model to models/celebrity_recognition_model.pth
2025-04-12 09:33:13,076 - INFO - Saved vocabulary for future predictions
2025-04-12 09:33:13,076 - INFO - Training completed successfully
2025-04-12 09:33:13,076 - INFO - Created prediction script: predict.py
2025-04-12 09:45:38,796 - INFO - Creating PyTorch model with convnext_small architecture
2025-04-12 09:45:39,676 - INFO - Model created and moved to cuda
2025-04-12 09:45:39,676 - INFO - Loading model from models/celebrity_recognition_model.pth
2025-04-12 09:45:39,788 - INFO - Model loaded successfully
2025-04-12 09:46:09,786 - INFO - Creating PyTorch model with convnext_small architecture
2025-04-12 09:46:10,666 - INFO - Model created and moved to cuda
2025-04-12 09:46:10,667 - INFO - Loading model from testpics/Amy_Lee.jpg
2025-04-12 09:46:10,669 - INFO - Error loading model: Weights only load failed. In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
Please file an issue with the following so that we can make `weights_only=True` compatible with your use case: WeightsUnpickler error: Unsupported operand 255

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-04-12 21:37:00,034 - INFO - Starting celebrity recognition training pipeline
2025-04-12 21:37:00,034 - INFO - GPU Memory: 0.00MB allocated, 0.00MB cached
2025-04-12 21:37:00,034 - INFO - Loading identity data...
2025-04-12 21:37:00,174 - INFO - Loaded 202600 image identity records
2025-04-12 21:37:02,437 - INFO - Filtered out 1 missing images
2025-04-12 21:37:02,477 - INFO - After minimum image filtering: 0 images of 0 celebrities
2025-04-12 21:37:02,478 - INFO - Class distribution - Min: nan, Max: nan, Avg: nan images per celebrity
2025-04-12 21:37:02,478 - INFO - Creating pure PyTorch datasets...
2025-04-12 21:37:02,479 - INFO - Error in main execution: With n_samples=0, test_size=0.2 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
2025-04-12 21:37:02,483 - INFO - Traceback (most recent call last):
  File "/home/dave/torch/celeba/celebrity_recognition.py", line 1421, in <module>
    main()
  File "/home/dave/torch/celeba/celebrity_recognition.py", line 1357, in main
    dls = setup_data_loaders(df, img_size=IMAGE_SIZE)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/celebrity_recognition.py", line 358, in setup_data_loaders
    return create_pure_pytorch_datasets(df, img_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/celebrity_recognition.py", line 180, in create_pure_pytorch_datasets
    train_df, valid_df = train_test_split(
                         ^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 2851, in train_test_split
    n_train, n_test = _validate_shuffle_split(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dave/torch/celeba/venv/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 2481, in _validate_shuffle_split
    raise ValueError(
ValueError: With n_samples=0, test_size=0.2 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

2025-04-12 21:45:15,676 - INFO - Starting celebrity recognition training pipeline
2025-04-12 21:45:15,677 - INFO - GPU Memory: 0.00MB allocated, 0.00MB cached
2025-04-12 21:45:15,677 - INFO - Loading identity data...
2025-04-12 21:45:16,670 - INFO - Found 202599 files in img_align_celeba
2025-04-12 21:45:16,670 - INFO - Sample files: ['034659.jpg', '047770.jpg', '085721.jpg', '055323.jpg', '055990.jpg']
2025-04-12 21:45:16,838 - INFO - Loaded 202599 image identity records
2025-04-12 21:45:19,038 - INFO - Celebrity counts: identity_name
Heidi_Range          35
Fonzworth_Bentley    35
Ekaterina_Vilkova    35
Havana_Brown         34
Hank_Baskett         34
                     ..
Scott_Parsons         1
Cindy_Dolenc          1
Vicki_Sato            1
Grant_Turner          1
Hamish_McColl         1
Name: count, Length: 10177, dtype: int64
2025-04-12 21:45:19,059 - INFO - After minimum image filtering: 193569 images of 8369 celebrities
2025-04-12 21:45:19,100 - INFO - Limited to top 10 celebrities (331 images)
2025-04-12 21:45:19,100 - INFO - Class distribution - Min: 31, Max: 35, Avg: 33.1 images per celebrity
2025-04-12 21:45:19,101 - INFO - Creating pure PyTorch datasets...
2025-04-12 21:45:19,102 - INFO - Training set: 264 images
2025-04-12 21:45:19,102 - INFO - Validation set: 67 images
2025-04-12 21:45:19,104 - INFO - Created datasets with 264 training and 67 validation samples
2025-04-12 21:45:19,105 - INFO - Created balanced class weights with range: 0.97 - 1.03
2025-04-12 21:45:19,105 - INFO - Created data loaders with 10 classes
2025-04-12 21:45:19,105 - INFO - Creating pure PyTorch datasets...
2025-04-12 21:45:19,107 - INFO - Training set: 264 images
2025-04-12 21:45:19,107 - INFO - Validation set: 67 images
2025-04-12 21:45:19,108 - INFO - Created datasets with 264 training and 67 validation samples
2025-04-12 21:45:19,109 - INFO - Created balanced class weights with range: 0.97 - 1.03
2025-04-12 21:45:19,109 - INFO - Created secondary data loaders with image size 320
2025-04-12 21:45:19,109 - INFO - Using pure PyTorch implementation for training
2025-04-12 21:45:19,109 - INFO - Creating PyTorch model with resnet50 architecture
2025-04-12 21:45:19,779 - INFO - Model created and moved to cuda
2025-04-12 21:45:19,779 - INFO - Added dropout and normalization layers for better regularization
2025-04-12 21:45:19,780 - INFO - Training PyTorch model for 10 epochs with learning rate 0.0005
2025-04-12 21:45:19,780 - INFO - GPU Memory: 93.97MB allocated, 118.00MB cached
2025-04-12 21:45:19,780 - INFO - Using weighted loss function
2025-04-12 21:45:19,780 - INFO - Using Focal Loss with class weights
2025-04-12 21:45:19,781 - INFO - Using Cosine Annealing scheduler with warm restarts
2025-04-12 21:45:19,781 - INFO - Using gradient accumulation with 2 steps (effective batch size: 16)
2025-04-12 21:45:19,781 - INFO - Epoch 1/10
2025-04-12 21:45:24,776 - INFO - Batch 20/33 - Loss: 12.2569
2025-04-12 21:45:24,777 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:45:27,655 - INFO - Current learning rate: 0.0004884
2025-04-12 21:45:28,325 - INFO - Epoch 1 results:
2025-04-12 21:45:28,325 - INFO - Train Loss: 14.6436, Train Acc: 0.1288
2025-04-12 21:45:28,325 - INFO - Val Loss: 7.7794, Val Acc: 0.2388, Top-3 Acc: 0.6119
2025-04-12 21:45:28,325 - INFO - Epoch time: 8.54s
2025-04-12 21:45:28,865 - INFO - Saved new best model with accuracy 0.2388
2025-04-12 21:45:29,412 - INFO - Saved latest model for epoch 1
2025-04-12 21:45:29,412 - INFO - Epoch 2/10
2025-04-12 21:45:33,954 - INFO - Batch 20/33 - Loss: 11.0982
2025-04-12 21:45:33,955 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:45:36,840 - INFO - Current learning rate: 0.0004546
2025-04-12 21:45:37,475 - INFO - Epoch 2 results:
2025-04-12 21:45:37,475 - INFO - Train Loss: 10.1261, Train Acc: 0.3322
2025-04-12 21:45:37,476 - INFO - Val Loss: 9.8678, Val Acc: 0.3284, Top-3 Acc: 0.6418
2025-04-12 21:45:37,476 - INFO - Epoch time: 8.06s
2025-04-12 21:45:38,017 - INFO - Saved new best model with accuracy 0.3284
2025-04-12 21:45:38,546 - INFO - Saved latest model for epoch 2
2025-04-12 21:45:38,546 - INFO - Epoch 3/10
2025-04-12 21:45:43,092 - INFO - Batch 20/33 - Loss: 4.7776
2025-04-12 21:45:43,093 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:45:45,970 - INFO - Current learning rate: 0.0004021
2025-04-12 21:45:46,605 - INFO - Epoch 3 results:
2025-04-12 21:45:46,605 - INFO - Train Loss: 9.0424, Train Acc: 0.3759
2025-04-12 21:45:46,606 - INFO - Val Loss: 6.4937, Val Acc: 0.4328, Top-3 Acc: 0.8060
2025-04-12 21:45:46,606 - INFO - Epoch time: 8.06s
2025-04-12 21:45:47,117 - INFO - Saved new best model with accuracy 0.4328
2025-04-12 21:45:47,647 - INFO - Saved latest model for epoch 3
2025-04-12 21:45:47,648 - INFO - Epoch 4/10
2025-04-12 21:45:52,195 - INFO - Batch 20/33 - Loss: 5.0654
2025-04-12 21:45:52,196 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:45:55,078 - INFO - Current learning rate: 0.0003359
2025-04-12 21:45:55,709 - INFO - Epoch 4 results:
2025-04-12 21:45:55,709 - INFO - Train Loss: 9.2176, Train Acc: 0.4129
2025-04-12 21:45:55,709 - INFO - Val Loss: 10.0875, Val Acc: 0.4627, Top-3 Acc: 0.6269
2025-04-12 21:45:55,710 - INFO - Epoch time: 8.06s
2025-04-12 21:45:56,231 - INFO - Saved new best model with accuracy 0.4627
2025-04-12 21:45:56,817 - INFO - Saved latest model for epoch 4
2025-04-12 21:45:56,817 - INFO - Epoch 5/10
2025-04-12 21:46:01,368 - INFO - Batch 20/33 - Loss: 13.3333
2025-04-12 21:46:01,369 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:04,252 - INFO - Current learning rate: 0.0002625
2025-04-12 21:46:04,875 - INFO - Epoch 5 results:
2025-04-12 21:46:04,876 - INFO - Train Loss: 8.0644, Train Acc: 0.4297
2025-04-12 21:46:04,876 - INFO - Val Loss: 5.5490, Val Acc: 0.5224, Top-3 Acc: 0.7910
2025-04-12 21:46:04,876 - INFO - Epoch time: 8.06s
2025-04-12 21:46:05,428 - INFO - Saved new best model with accuracy 0.5224
2025-04-12 21:46:06,026 - INFO - Saved latest model for epoch 5
2025-04-12 21:46:06,357 - INFO - Saved training curves to evaluation_results/training_curves_epoch5.png
2025-04-12 21:46:06,357 - INFO - Epoch 6/10
2025-04-12 21:46:10,888 - INFO - Batch 20/33 - Loss: 8.3706
2025-04-12 21:46:10,888 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:13,775 - INFO - Current learning rate: 0.0001891
2025-04-12 21:46:16,463 - INFO - Epoch 6 results:
2025-04-12 21:46:16,463 - INFO - Train Loss: 7.5642, Train Acc: 0.4763
2025-04-12 21:46:16,463 - INFO - Val Loss: 0.9089, Val Acc: 0.7313, Top-3 Acc: 0.8806
2025-04-12 21:46:16,463 - INFO - Epoch time: 10.11s
2025-04-12 21:46:16,978 - INFO - Saved new best model with accuracy 0.7313
2025-04-12 21:46:17,558 - INFO - Saved latest model for epoch 6
2025-04-12 21:46:17,558 - INFO - Epoch 7/10
2025-04-12 21:46:22,101 - INFO - Batch 20/33 - Loss: 5.5579
2025-04-12 21:46:22,102 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:24,993 - INFO - Current learning rate: 0.0001229
2025-04-12 21:46:27,664 - INFO - Epoch 7 results:
2025-04-12 21:46:27,665 - INFO - Train Loss: 5.7731, Train Acc: 0.5379
2025-04-12 21:46:27,665 - INFO - Val Loss: 0.9721, Val Acc: 0.7015, Top-3 Acc: 0.9104
2025-04-12 21:46:27,665 - INFO - Epoch time: 10.11s
2025-04-12 21:46:27,665 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-12 21:46:28,169 - INFO - Saved latest model for epoch 7
2025-04-12 21:46:28,170 - INFO - Epoch 8/10
2025-04-12 21:46:32,723 - INFO - Batch 20/33 - Loss: 4.3948
2025-04-12 21:46:32,724 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:35,614 - INFO - Current learning rate: 0.0000704
2025-04-12 21:46:38,272 - INFO - Epoch 8 results:
2025-04-12 21:46:38,272 - INFO - Train Loss: 5.9254, Train Acc: 0.5625
2025-04-12 21:46:38,272 - INFO - Val Loss: 0.8303, Val Acc: 0.7463, Top-3 Acc: 0.9104
2025-04-12 21:46:38,272 - INFO - Epoch time: 10.10s
2025-04-12 21:46:38,831 - INFO - Saved new best model with accuracy 0.7463
2025-04-12 21:46:39,428 - INFO - Saved latest model for epoch 8
2025-04-12 21:46:39,428 - INFO - Epoch 9/10
2025-04-12 21:46:43,994 - INFO - Batch 20/33 - Loss: 2.2268
2025-04-12 21:46:43,995 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:46,881 - INFO - Current learning rate: 0.0000366
2025-04-12 21:46:49,548 - INFO - Epoch 9 results:
2025-04-12 21:46:49,549 - INFO - Train Loss: 4.1136, Train Acc: 0.6098
2025-04-12 21:46:49,549 - INFO - Val Loss: 0.6742, Val Acc: 0.7164, Top-3 Acc: 0.8955
2025-04-12 21:46:49,549 - INFO - Epoch time: 10.12s
2025-04-12 21:46:49,549 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-12 21:46:50,040 - INFO - Saved latest model for epoch 9
2025-04-12 21:46:50,040 - INFO - Epoch 10/10
2025-04-12 21:46:54,583 - INFO - Batch 20/33 - Loss: 1.7804
2025-04-12 21:46:54,584 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-12 21:46:57,469 - INFO - Current learning rate: 0.0005000
2025-04-12 21:47:00,144 - INFO - Epoch 10 results:
2025-04-12 21:47:00,144 - INFO - Train Loss: 3.4566, Train Acc: 0.6856
2025-04-12 21:47:00,144 - INFO - Val Loss: 0.4929, Val Acc: 0.8060, Top-3 Acc: 0.9701
2025-04-12 21:47:00,144 - INFO - Epoch time: 10.10s
2025-04-12 21:47:00,662 - INFO - Saved new best model with accuracy 0.8060
2025-04-12 21:47:01,210 - INFO - Saved latest model for epoch 10
2025-04-12 21:47:01,471 - INFO - Saved training curves to evaluation_results/training_curves_epoch10.png
2025-04-12 21:47:01,471 - INFO - Training completed in 101.69s
2025-04-12 21:47:01,471 - INFO - Best validation accuracy: 0.8060
2025-04-12 21:47:01,554 - INFO - Fine-tuning with larger image size 320
2025-04-12 21:47:01,554 - INFO - Training PyTorch model for 15 epochs with learning rate 5e-05
2025-04-12 21:47:01,555 - INFO - GPU Memory: 110.22MB allocated, 1186.00MB cached
2025-04-12 21:47:01,555 - INFO - Using weighted loss function
2025-04-12 21:47:01,555 - INFO - Using Focal Loss with class weights
2025-04-12 21:47:01,556 - INFO - Using Cosine Annealing scheduler with warm restarts
2025-04-12 21:47:01,556 - INFO - Using gradient accumulation with 2 steps (effective batch size: 16)
2025-04-12 21:47:01,556 - INFO - Epoch 1/15
2025-04-12 21:47:09,745 - INFO - Batch 20/33 - Loss: 3.7340
2025-04-12 21:47:09,746 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:47:14,921 - INFO - Current learning rate: 0.0000495
2025-04-12 21:47:16,068 - INFO - Epoch 1 results:
2025-04-12 21:47:16,068 - INFO - Train Loss: 5.7604, Train Acc: 0.5753
2025-04-12 21:47:16,068 - INFO - Val Loss: 1.4294, Val Acc: 0.7910, Top-3 Acc: 0.9552
2025-04-12 21:47:16,068 - INFO - Epoch time: 14.51s
2025-04-12 21:47:16,599 - INFO - Saved new best model with accuracy 0.7910
2025-04-12 21:47:17,187 - INFO - Saved latest model for epoch 1
2025-04-12 21:47:17,188 - INFO - Epoch 2/15
2025-04-12 21:47:25,314 - INFO - Batch 20/33 - Loss: 6.2883
2025-04-12 21:47:25,314 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:47:30,492 - INFO - Current learning rate: 0.0000479
2025-04-12 21:47:31,609 - INFO - Epoch 2 results:
2025-04-12 21:47:31,609 - INFO - Train Loss: 4.9879, Train Acc: 0.6466
2025-04-12 21:47:31,609 - INFO - Val Loss: 1.2234, Val Acc: 0.8209, Top-3 Acc: 0.9851
2025-04-12 21:47:31,609 - INFO - Epoch time: 14.42s
2025-04-12 21:47:32,135 - INFO - Saved new best model with accuracy 0.8209
2025-04-12 21:47:32,677 - INFO - Saved latest model for epoch 2
2025-04-12 21:47:32,677 - INFO - Epoch 3/15
2025-04-12 21:47:40,816 - INFO - Batch 20/33 - Loss: 10.1470
2025-04-12 21:47:40,817 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:47:45,995 - INFO - Current learning rate: 0.0000455
2025-04-12 21:47:47,113 - INFO - Epoch 3 results:
2025-04-12 21:47:47,114 - INFO - Train Loss: 5.0587, Train Acc: 0.5990
2025-04-12 21:47:47,114 - INFO - Val Loss: 1.1569, Val Acc: 0.8507, Top-3 Acc: 1.0000
2025-04-12 21:47:47,114 - INFO - Epoch time: 14.44s
2025-04-12 21:47:47,622 - INFO - Saved new best model with accuracy 0.8507
2025-04-12 21:47:48,168 - INFO - Saved latest model for epoch 3
2025-04-12 21:47:48,169 - INFO - Epoch 4/15
2025-04-12 21:47:56,297 - INFO - Batch 20/33 - Loss: 2.4071
2025-04-12 21:47:56,297 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:48:01,481 - INFO - Current learning rate: 0.0000421
2025-04-12 21:48:02,610 - INFO - Epoch 4 results:
2025-04-12 21:48:02,610 - INFO - Train Loss: 4.1972, Train Acc: 0.6663
2025-04-12 21:48:02,610 - INFO - Val Loss: 1.3425, Val Acc: 0.8507, Top-3 Acc: 0.9851
2025-04-12 21:48:02,610 - INFO - Epoch time: 14.44s
2025-04-12 21:48:02,610 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-12 21:48:03,090 - INFO - Saved latest model for epoch 4
2025-04-12 21:48:03,090 - INFO - Epoch 5/15
2025-04-12 21:48:11,215 - INFO - Batch 20/33 - Loss: 2.4560
2025-04-12 21:48:11,216 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:48:16,391 - INFO - Current learning rate: 0.0000381
2025-04-12 21:48:17,520 - INFO - Epoch 5 results:
2025-04-12 21:48:17,520 - INFO - Train Loss: 4.3443, Train Acc: 0.6214
2025-04-12 21:48:17,521 - INFO - Val Loss: 1.6016, Val Acc: 0.8209, Top-3 Acc: 0.9701
2025-04-12 21:48:17,521 - INFO - Epoch time: 14.43s
2025-04-12 21:48:17,521 - INFO - Validation accuracy did not improve. Early stopping counter: 2/5
2025-04-12 21:48:18,074 - INFO - Saved latest model for epoch 5
2025-04-12 21:48:18,352 - INFO - Saved training curves to evaluation_results/training_curves_epoch5.png
2025-04-12 21:48:18,352 - INFO - Epoch 6/15
2025-04-12 21:48:26,462 - INFO - Batch 20/33 - Loss: 10.5462
2025-04-12 21:48:26,463 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:48:31,651 - INFO - Current learning rate: 0.0000336
2025-04-12 21:48:32,768 - INFO - Epoch 6 results:
2025-04-12 21:48:32,769 - INFO - Train Loss: 3.5371, Train Acc: 0.6694
2025-04-12 21:48:32,769 - INFO - Val Loss: 1.3821, Val Acc: 0.7910, Top-3 Acc: 0.9851
2025-04-12 21:48:32,769 - INFO - Epoch time: 14.42s
2025-04-12 21:48:32,769 - INFO - Validation accuracy did not improve. Early stopping counter: 3/5
2025-04-12 21:48:33,309 - INFO - Saved latest model for epoch 6
2025-04-12 21:48:33,310 - INFO - Epoch 7/15
2025-04-12 21:48:41,449 - INFO - Batch 20/33 - Loss: 0.6200
2025-04-12 21:48:41,450 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:48:46,629 - INFO - Current learning rate: 0.0000287
2025-04-12 21:48:47,758 - INFO - Epoch 7 results:
2025-04-12 21:48:47,758 - INFO - Train Loss: 3.7601, Train Acc: 0.6975
2025-04-12 21:48:47,758 - INFO - Val Loss: 1.2883, Val Acc: 0.8209, Top-3 Acc: 0.9851
2025-04-12 21:48:47,758 - INFO - Epoch time: 14.45s
2025-04-12 21:48:47,758 - INFO - Validation accuracy did not improve. Early stopping counter: 4/5
2025-04-12 21:48:48,301 - INFO - Saved latest model for epoch 7
2025-04-12 21:48:48,302 - INFO - Epoch 8/15
2025-04-12 21:48:56,424 - INFO - Batch 20/33 - Loss: 7.4671
2025-04-12 21:48:56,425 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-12 21:49:01,605 - INFO - Current learning rate: 0.0000238
2025-04-12 21:49:06,683 - INFO - Epoch 8 results:
2025-04-12 21:49:06,683 - INFO - Train Loss: 4.2165, Train Acc: 0.6965
2025-04-12 21:49:06,684 - INFO - Val Loss: 0.1399, Val Acc: 0.8507, Top-3 Acc: 1.0000
2025-04-12 21:49:06,684 - INFO - Epoch time: 18.38s
2025-04-12 21:49:06,684 - INFO - Validation accuracy did not improve. Early stopping counter: 5/5
2025-04-12 21:49:07,177 - INFO - Saved latest model for epoch 8
2025-04-12 21:49:07,178 - INFO - Early stopping triggered after 8 epochs
2025-04-12 21:49:07,178 - INFO - Training completed in 125.62s
2025-04-12 21:49:07,178 - INFO - Best validation accuracy: 0.8507
2025-04-12 21:49:07,801 - INFO - Saved final model to models/celebrity_recognition_model.pth
2025-04-12 21:49:07,802 - INFO - Saved vocabulary for future predictions
2025-04-12 21:49:07,803 - INFO - Training completed successfully
2025-04-12 21:49:07,803 - INFO - Created prediction script: predict.py
2025-04-12 21:52:17,736 - INFO - Creating PyTorch model with resnet50 architecture
2025-04-12 21:52:18,212 - INFO - Model created and moved to cuda
2025-04-12 21:52:18,213 - INFO - Added dropout and normalization layers for better regularization
2025-04-12 21:52:18,213 - INFO - Loading model from models/celebrity_recognition_model.pth
2025-04-12 21:52:18,298 - INFO - Error loading model: Error(s) in loading state_dict for ResNet:
	size mismatch for fc.6.weight: copying a param with shape torch.Size([10, 512]) from checkpoint, the shape in current model is torch.Size([30, 512]).
	size mismatch for fc.6.bias: copying a param with shape torch.Size([10]) from checkpoint, the shape in current model is torch.Size([30]).
2025-04-15 14:10:39,005 - INFO - Starting celebrity recognition training pipeline
2025-04-15 14:10:39,005 - INFO - GPU Memory: 0.00MB allocated, 0.00MB cached
2025-04-15 14:10:39,006 - INFO - Loading identity data...
2025-04-15 14:10:40,072 - INFO - Found 202599 files in /home/dave/torch/celeba_images/img_align_celeba
2025-04-15 14:10:40,072 - INFO - Sample files: ['110740.jpg', '049093.jpg', '117700.jpg', '198326.jpg', '073171.jpg']
2025-04-15 14:10:40,246 - INFO - Loaded 202599 image identity records
2025-04-15 14:10:42,647 - INFO - Celebrity counts: identity_name
Heidi_Range          35
Fonzworth_Bentley    35
Ekaterina_Vilkova    35
Havana_Brown         34
Hank_Baskett         34
                     ..
Scott_Parsons         1
Cindy_Dolenc          1
Vicki_Sato            1
Grant_Turner          1
Hamish_McColl         1
Name: count, Length: 10177, dtype: int64
2025-04-15 14:10:42,668 - INFO - After minimum image filtering: 193569 images of 8369 celebrities
2025-04-15 14:10:42,710 - INFO - Limited to top 10 celebrities (331 images)
2025-04-15 14:10:42,710 - INFO - Class distribution - Min: 31, Max: 35, Avg: 33.1 images per celebrity
2025-04-15 14:10:42,711 - INFO - Creating pure PyTorch datasets...
2025-04-15 14:10:42,714 - INFO - Training set: 264 images
2025-04-15 14:10:42,714 - INFO - Validation set: 67 images
2025-04-15 14:10:42,716 - INFO - Created datasets with 264 training and 67 validation samples
2025-04-15 14:10:42,717 - INFO - Created balanced class weights with range: 0.97 - 1.03
2025-04-15 14:10:42,717 - INFO - Created data loaders with 10 classes
2025-04-15 14:10:42,718 - INFO - Creating pure PyTorch datasets...
2025-04-15 14:10:42,719 - INFO - Training set: 264 images
2025-04-15 14:10:42,719 - INFO - Validation set: 67 images
2025-04-15 14:10:42,720 - INFO - Created datasets with 264 training and 67 validation samples
2025-04-15 14:10:42,721 - INFO - Created balanced class weights with range: 0.97 - 1.03
2025-04-15 14:10:42,721 - INFO - Created secondary data loaders with image size 320
2025-04-15 14:10:42,721 - INFO - Using pure PyTorch implementation for training
2025-04-15 14:10:42,722 - INFO - Creating PyTorch model with resnet50 architecture
2025-04-15 14:10:54,170 - INFO - Model created and moved to cuda
2025-04-15 14:10:54,171 - INFO - Added dropout and normalization layers for better regularization
2025-04-15 14:10:54,171 - INFO - Training PyTorch model for 10 epochs with learning rate 0.0005
2025-04-15 14:10:54,171 - INFO - GPU Memory: 93.97MB allocated, 118.00MB cached
2025-04-15 14:10:54,171 - INFO - Using weighted loss function
2025-04-15 14:10:54,171 - INFO - Using Focal Loss with class weights
2025-04-15 14:10:54,172 - INFO - Using Cosine Annealing scheduler with warm restarts
2025-04-15 14:10:54,172 - INFO - Using gradient accumulation with 2 steps (effective batch size: 16)
2025-04-15 14:10:54,172 - INFO - Epoch 1/10
2025-04-15 14:10:59,199 - INFO - Batch 20/33 - Loss: 16.0720
2025-04-15 14:10:59,200 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:02,074 - INFO - Current learning rate: 0.0004884
2025-04-15 14:11:02,767 - INFO - Epoch 1 results:
2025-04-15 14:11:02,767 - INFO - Train Loss: 15.2497, Train Acc: 0.1450
2025-04-15 14:11:02,767 - INFO - Val Loss: 6.6283, Val Acc: 0.2388, Top-3 Acc: 0.4179
2025-04-15 14:11:02,767 - INFO - Epoch time: 8.60s
2025-04-15 14:11:02,876 - INFO - Saved new best model with accuracy 0.2388
2025-04-15 14:11:02,979 - INFO - Saved latest model for epoch 1
2025-04-15 14:11:02,979 - INFO - Epoch 2/10
2025-04-15 14:11:07,492 - INFO - Batch 20/33 - Loss: 10.0018
2025-04-15 14:11:07,493 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:10,377 - INFO - Current learning rate: 0.0004546
2025-04-15 14:11:11,014 - INFO - Epoch 2 results:
2025-04-15 14:11:11,014 - INFO - Train Loss: 10.8574, Train Acc: 0.2528
2025-04-15 14:11:11,014 - INFO - Val Loss: 6.5789, Val Acc: 0.3134, Top-3 Acc: 0.6269
2025-04-15 14:11:11,014 - INFO - Epoch time: 8.04s
2025-04-15 14:11:11,328 - INFO - Saved new best model with accuracy 0.3134
2025-04-15 14:11:11,433 - INFO - Saved latest model for epoch 2
2025-04-15 14:11:11,433 - INFO - Epoch 3/10
2025-04-15 14:11:15,963 - INFO - Batch 20/33 - Loss: 12.5129
2025-04-15 14:11:15,964 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:18,850 - INFO - Current learning rate: 0.0004021
2025-04-15 14:11:19,483 - INFO - Epoch 3 results:
2025-04-15 14:11:19,483 - INFO - Train Loss: 9.8368, Train Acc: 0.3503
2025-04-15 14:11:19,483 - INFO - Val Loss: 6.3322, Val Acc: 0.4627, Top-3 Acc: 0.7313
2025-04-15 14:11:19,484 - INFO - Epoch time: 8.05s
2025-04-15 14:11:19,897 - INFO - Saved new best model with accuracy 0.4627
2025-04-15 14:11:20,002 - INFO - Saved latest model for epoch 3
2025-04-15 14:11:20,002 - INFO - Epoch 4/10
2025-04-15 14:11:24,518 - INFO - Batch 20/33 - Loss: 2.0749
2025-04-15 14:11:24,518 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:27,399 - INFO - Current learning rate: 0.0003359
2025-04-15 14:11:28,026 - INFO - Epoch 4 results:
2025-04-15 14:11:28,026 - INFO - Train Loss: 6.1944, Train Acc: 0.5079
2025-04-15 14:11:28,026 - INFO - Val Loss: 5.1308, Val Acc: 0.4776, Top-3 Acc: 0.7910
2025-04-15 14:11:28,026 - INFO - Epoch time: 8.02s
2025-04-15 14:11:28,423 - INFO - Saved new best model with accuracy 0.4776
2025-04-15 14:11:28,527 - INFO - Saved latest model for epoch 4
2025-04-15 14:11:28,527 - INFO - Epoch 5/10
2025-04-15 14:11:33,050 - INFO - Batch 20/33 - Loss: 5.2720
2025-04-15 14:11:33,051 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:35,933 - INFO - Current learning rate: 0.0002625
2025-04-15 14:11:36,570 - INFO - Epoch 5 results:
2025-04-15 14:11:36,571 - INFO - Train Loss: 8.2968, Train Acc: 0.4647
2025-04-15 14:11:36,571 - INFO - Val Loss: 3.7393, Val Acc: 0.4925, Top-3 Acc: 0.8209
2025-04-15 14:11:36,571 - INFO - Epoch time: 8.04s
2025-04-15 14:11:37,062 - INFO - Saved new best model with accuracy 0.4925
2025-04-15 14:11:37,166 - INFO - Saved latest model for epoch 5
2025-04-15 14:11:37,433 - INFO - Saved training curves to evaluation_results/training_curves_epoch5.png
2025-04-15 14:11:37,434 - INFO - Epoch 6/10
2025-04-15 14:11:41,952 - INFO - Batch 20/33 - Loss: 4.2723
2025-04-15 14:11:41,953 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:44,834 - INFO - Current learning rate: 0.0001891
2025-04-15 14:11:47,504 - INFO - Epoch 6 results:
2025-04-15 14:11:47,504 - INFO - Train Loss: 7.3445, Train Acc: 0.4400
2025-04-15 14:11:47,505 - INFO - Val Loss: 1.3544, Val Acc: 0.6716, Top-3 Acc: 0.8358
2025-04-15 14:11:47,505 - INFO - Epoch time: 10.07s
2025-04-15 14:11:48,136 - INFO - Saved new best model with accuracy 0.6716
2025-04-15 14:11:48,239 - INFO - Saved latest model for epoch 6
2025-04-15 14:11:48,239 - INFO - Epoch 7/10
2025-04-15 14:11:52,761 - INFO - Batch 20/33 - Loss: 7.6633
2025-04-15 14:11:52,762 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:11:55,654 - INFO - Current learning rate: 0.0001229
2025-04-15 14:11:58,308 - INFO - Epoch 7 results:
2025-04-15 14:11:58,308 - INFO - Train Loss: 6.0536, Train Acc: 0.5275
2025-04-15 14:11:58,308 - INFO - Val Loss: 1.0114, Val Acc: 0.5821, Top-3 Acc: 0.8806
2025-04-15 14:11:58,308 - INFO - Epoch time: 10.07s
2025-04-15 14:11:58,308 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:11:58,417 - INFO - Saved latest model for epoch 7
2025-04-15 14:11:58,417 - INFO - Epoch 8/10
2025-04-15 14:12:02,939 - INFO - Batch 20/33 - Loss: 2.8579
2025-04-15 14:12:02,940 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:12:05,832 - INFO - Current learning rate: 0.0000704
2025-04-15 14:12:08,493 - INFO - Epoch 8 results:
2025-04-15 14:12:08,493 - INFO - Train Loss: 6.4048, Train Acc: 0.5518
2025-04-15 14:12:08,494 - INFO - Val Loss: 0.5368, Val Acc: 0.7164, Top-3 Acc: 0.9254
2025-04-15 14:12:08,494 - INFO - Epoch time: 10.08s
2025-04-15 14:12:09,311 - INFO - Saved new best model with accuracy 0.7164
2025-04-15 14:12:09,415 - INFO - Saved latest model for epoch 8
2025-04-15 14:12:09,415 - INFO - Epoch 9/10
2025-04-15 14:12:13,925 - INFO - Batch 20/33 - Loss: 1.2550
2025-04-15 14:12:13,926 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:12:16,810 - INFO - Current learning rate: 0.0000366
2025-04-15 14:12:19,472 - INFO - Epoch 9 results:
2025-04-15 14:12:19,472 - INFO - Train Loss: 4.2896, Train Acc: 0.6326
2025-04-15 14:12:19,472 - INFO - Val Loss: 0.5733, Val Acc: 0.7463, Top-3 Acc: 0.9552
2025-04-15 14:12:19,472 - INFO - Epoch time: 10.06s
2025-04-15 14:12:20,116 - INFO - Saved new best model with accuracy 0.7463
2025-04-15 14:12:20,220 - INFO - Saved latest model for epoch 9
2025-04-15 14:12:20,221 - INFO - Epoch 10/10
2025-04-15 14:12:24,731 - INFO - Batch 20/33 - Loss: 2.3071
2025-04-15 14:12:24,732 - INFO - GPU Memory: 314.27MB allocated, 1186.00MB cached
2025-04-15 14:12:27,619 - INFO - Current learning rate: 0.0005000
2025-04-15 14:12:30,280 - INFO - Epoch 10 results:
2025-04-15 14:12:30,280 - INFO - Train Loss: 4.3006, Train Acc: 0.6098
2025-04-15 14:12:30,280 - INFO - Val Loss: 0.5493, Val Acc: 0.7313, Top-3 Acc: 0.9851
2025-04-15 14:12:30,280 - INFO - Epoch time: 10.06s
2025-04-15 14:12:30,281 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:12:30,389 - INFO - Saved latest model for epoch 10
2025-04-15 14:12:30,622 - INFO - Saved training curves to evaluation_results/training_curves_epoch10.png
2025-04-15 14:12:30,622 - INFO - Training completed in 96.45s
2025-04-15 14:12:30,622 - INFO - Best validation accuracy: 0.7463
2025-04-15 14:12:30,704 - INFO - Fine-tuning with larger image size 320
2025-04-15 14:12:30,704 - INFO - Training PyTorch model for 15 epochs with learning rate 5e-05
2025-04-15 14:12:30,704 - INFO - GPU Memory: 110.22MB allocated, 1186.00MB cached
2025-04-15 14:12:30,705 - INFO - Using weighted loss function
2025-04-15 14:12:30,705 - INFO - Using Focal Loss with class weights
2025-04-15 14:12:30,705 - INFO - Using Cosine Annealing scheduler with warm restarts
2025-04-15 14:12:30,706 - INFO - Using gradient accumulation with 2 steps (effective batch size: 16)
2025-04-15 14:12:30,706 - INFO - Epoch 1/15
2025-04-15 14:12:38,865 - INFO - Batch 20/33 - Loss: 10.2539
2025-04-15 14:12:38,866 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:12:44,038 - INFO - Current learning rate: 0.0000495
2025-04-15 14:12:45,161 - INFO - Epoch 1 results:
2025-04-15 14:12:45,162 - INFO - Train Loss: 5.6010, Train Acc: 0.5363
2025-04-15 14:12:45,162 - INFO - Val Loss: 2.7752, Val Acc: 0.6418, Top-3 Acc: 0.9104
2025-04-15 14:12:45,162 - INFO - Epoch time: 14.46s
2025-04-15 14:12:45,491 - INFO - Saved new best model with accuracy 0.6418
2025-04-15 14:12:45,866 - INFO - Saved latest model for epoch 1
2025-04-15 14:12:45,867 - INFO - Epoch 2/15
2025-04-15 14:12:53,957 - INFO - Batch 20/33 - Loss: 3.5664
2025-04-15 14:12:53,958 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:12:59,132 - INFO - Current learning rate: 0.0000479
2025-04-15 14:13:00,247 - INFO - Epoch 2 results:
2025-04-15 14:13:00,247 - INFO - Train Loss: 4.4927, Train Acc: 0.5912
2025-04-15 14:13:00,248 - INFO - Val Loss: 2.8145, Val Acc: 0.6716, Top-3 Acc: 0.9403
2025-04-15 14:13:00,248 - INFO - Epoch time: 14.38s
2025-04-15 14:13:00,572 - INFO - Saved new best model with accuracy 0.6716
2025-04-15 14:13:00,950 - INFO - Saved latest model for epoch 2
2025-04-15 14:13:00,950 - INFO - Epoch 3/15
2025-04-15 14:13:09,066 - INFO - Batch 20/33 - Loss: 2.7981
2025-04-15 14:13:09,067 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:13:14,245 - INFO - Current learning rate: 0.0000455
2025-04-15 14:13:15,380 - INFO - Epoch 3 results:
2025-04-15 14:13:15,380 - INFO - Train Loss: 4.3094, Train Acc: 0.6184
2025-04-15 14:13:15,380 - INFO - Val Loss: 2.5643, Val Acc: 0.7313, Top-3 Acc: 0.9254
2025-04-15 14:13:15,380 - INFO - Epoch time: 14.43s
2025-04-15 14:13:15,710 - INFO - Saved new best model with accuracy 0.7313
2025-04-15 14:13:16,187 - INFO - Saved latest model for epoch 3
2025-04-15 14:13:16,187 - INFO - Epoch 4/15
2025-04-15 14:13:24,303 - INFO - Batch 20/33 - Loss: 9.2427
2025-04-15 14:13:24,304 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:13:29,482 - INFO - Current learning rate: 0.0000421
2025-04-15 14:13:30,604 - INFO - Epoch 4 results:
2025-04-15 14:13:30,604 - INFO - Train Loss: 5.2273, Train Acc: 0.6081
2025-04-15 14:13:30,604 - INFO - Val Loss: 2.7630, Val Acc: 0.7313, Top-3 Acc: 0.9254
2025-04-15 14:13:30,605 - INFO - Epoch time: 14.42s
2025-04-15 14:13:30,605 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:13:30,932 - INFO - Saved latest model for epoch 4
2025-04-15 14:13:30,932 - INFO - Epoch 5/15
2025-04-15 14:13:39,056 - INFO - Batch 20/33 - Loss: 3.1829
2025-04-15 14:13:39,057 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:13:44,233 - INFO - Current learning rate: 0.0000381
2025-04-15 14:13:45,364 - INFO - Epoch 5 results:
2025-04-15 14:13:45,365 - INFO - Train Loss: 5.0108, Train Acc: 0.6088
2025-04-15 14:13:45,365 - INFO - Val Loss: 2.5662, Val Acc: 0.7612, Top-3 Acc: 0.9104
2025-04-15 14:13:45,365 - INFO - Epoch time: 14.43s
2025-04-15 14:13:45,704 - INFO - Saved new best model with accuracy 0.7612
2025-04-15 14:13:46,207 - INFO - Saved latest model for epoch 5
2025-04-15 14:13:46,478 - INFO - Saved training curves to evaluation_results/training_curves_epoch5.png
2025-04-15 14:13:46,478 - INFO - Epoch 6/15
2025-04-15 14:13:54,577 - INFO - Batch 20/33 - Loss: 6.5214
2025-04-15 14:13:54,578 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:13:59,754 - INFO - Current learning rate: 0.0000336
2025-04-15 14:14:00,896 - INFO - Epoch 6 results:
2025-04-15 14:14:00,896 - INFO - Train Loss: 4.5024, Train Acc: 0.6246
2025-04-15 14:14:00,896 - INFO - Val Loss: 2.4490, Val Acc: 0.7164, Top-3 Acc: 0.9403
2025-04-15 14:14:00,896 - INFO - Epoch time: 14.42s
2025-04-15 14:14:00,896 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:14:01,216 - INFO - Saved latest model for epoch 6
2025-04-15 14:14:01,216 - INFO - Epoch 7/15
2025-04-15 14:14:09,321 - INFO - Batch 20/33 - Loss: 9.3596
2025-04-15 14:14:09,322 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:14:14,510 - INFO - Current learning rate: 0.0000287
2025-04-15 14:14:15,632 - INFO - Epoch 7 results:
2025-04-15 14:14:15,633 - INFO - Train Loss: 3.9109, Train Acc: 0.6126
2025-04-15 14:14:15,633 - INFO - Val Loss: 2.2659, Val Acc: 0.7164, Top-3 Acc: 0.9403
2025-04-15 14:14:15,633 - INFO - Epoch time: 14.42s
2025-04-15 14:14:15,633 - INFO - Validation accuracy did not improve. Early stopping counter: 2/5
2025-04-15 14:14:15,955 - INFO - Saved latest model for epoch 7
2025-04-15 14:14:15,955 - INFO - Epoch 8/15
2025-04-15 14:14:24,068 - INFO - Batch 20/33 - Loss: 2.2615
2025-04-15 14:14:24,069 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:14:29,252 - INFO - Current learning rate: 0.0000238
2025-04-15 14:14:34,312 - INFO - Epoch 8 results:
2025-04-15 14:14:34,312 - INFO - Train Loss: 3.8505, Train Acc: 0.6864
2025-04-15 14:14:34,312 - INFO - Val Loss: 1.0222, Val Acc: 0.7015, Top-3 Acc: 0.8955
2025-04-15 14:14:34,312 - INFO - Epoch time: 18.36s
2025-04-15 14:14:34,312 - INFO - Validation accuracy did not improve. Early stopping counter: 3/5
2025-04-15 14:14:34,971 - INFO - Saved latest model for epoch 8
2025-04-15 14:14:34,972 - INFO - Epoch 9/15
2025-04-15 14:14:43,092 - INFO - Batch 20/33 - Loss: 4.2215
2025-04-15 14:14:43,093 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:14:48,279 - INFO - Current learning rate: 0.0000189
2025-04-15 14:14:53,338 - INFO - Epoch 9 results:
2025-04-15 14:14:53,338 - INFO - Train Loss: 5.1058, Train Acc: 0.6367
2025-04-15 14:14:53,338 - INFO - Val Loss: 0.6339, Val Acc: 0.7761, Top-3 Acc: 0.9552
2025-04-15 14:14:53,338 - INFO - Epoch time: 18.37s
2025-04-15 14:14:53,709 - INFO - Saved new best model with accuracy 0.7761
2025-04-15 14:14:54,685 - INFO - Saved latest model for epoch 9
2025-04-15 14:14:54,685 - INFO - Epoch 10/15
2025-04-15 14:15:02,797 - INFO - Batch 20/33 - Loss: 12.6289
2025-04-15 14:15:02,798 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:15:07,980 - INFO - Current learning rate: 0.0000144
2025-04-15 14:15:13,067 - INFO - Epoch 10 results:
2025-04-15 14:15:13,067 - INFO - Train Loss: 3.4890, Train Acc: 0.6769
2025-04-15 14:15:13,068 - INFO - Val Loss: 0.8521, Val Acc: 0.7761, Top-3 Acc: 0.9104
2025-04-15 14:15:13,068 - INFO - Epoch time: 18.38s
2025-04-15 14:15:13,068 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:15:13,835 - INFO - Saved latest model for epoch 10
2025-04-15 14:15:14,055 - INFO - Saved training curves to evaluation_results/training_curves_epoch10.png
2025-04-15 14:15:14,055 - INFO - Epoch 11/15
2025-04-15 14:15:22,172 - INFO - Batch 20/33 - Loss: 2.5048
2025-04-15 14:15:22,173 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:15:27,364 - INFO - Current learning rate: 0.0000104
2025-04-15 14:15:32,416 - INFO - Epoch 11 results:
2025-04-15 14:15:32,416 - INFO - Train Loss: 3.7529, Train Acc: 0.6809
2025-04-15 14:15:32,417 - INFO - Val Loss: 0.3864, Val Acc: 0.7761, Top-3 Acc: 0.9552
2025-04-15 14:15:32,417 - INFO - Epoch time: 18.36s
2025-04-15 14:15:32,417 - INFO - Validation accuracy did not improve. Early stopping counter: 2/5
2025-04-15 14:15:32,525 - INFO - Saved latest model for epoch 11
2025-04-15 14:15:32,525 - INFO - Epoch 12/15
2025-04-15 14:15:40,653 - INFO - Batch 20/33 - Loss: 2.8417
2025-04-15 14:15:40,654 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:15:45,843 - INFO - Current learning rate: 0.0000070
2025-04-15 14:15:50,931 - INFO - Epoch 12 results:
2025-04-15 14:15:50,932 - INFO - Train Loss: 3.6155, Train Acc: 0.6924
2025-04-15 14:15:50,932 - INFO - Val Loss: 0.6608, Val Acc: 0.8209, Top-3 Acc: 0.9403
2025-04-15 14:15:50,932 - INFO - Epoch time: 18.41s
2025-04-15 14:15:51,356 - INFO - Saved new best model with accuracy 0.8209
2025-04-15 14:15:51,460 - INFO - Saved latest model for epoch 12
2025-04-15 14:15:51,460 - INFO - Epoch 13/15
2025-04-15 14:15:59,598 - INFO - Batch 20/33 - Loss: 2.8229
2025-04-15 14:15:59,599 - INFO - GPU Memory: 323.55MB allocated, 1950.00MB cached
2025-04-15 14:16:04,779 - INFO - Current learning rate: 0.0000046
2025-04-15 14:16:09,858 - INFO - Epoch 13 results:
2025-04-15 14:16:09,858 - INFO - Train Loss: 4.0095, Train Acc: 0.6962
2025-04-15 14:16:09,858 - INFO - Val Loss: 0.5671, Val Acc: 0.7463, Top-3 Acc: 0.9403
2025-04-15 14:16:09,858 - INFO - Epoch time: 18.40s
2025-04-15 14:16:09,858 - INFO - Validation accuracy did not improve. Early stopping counter: 1/5
2025-04-15 14:16:09,966 - INFO - Saved latest model for epoch 13
2025-04-15 14:16:09,966 - INFO - Epoch 14/15
2025-04-15 14:16:18,046 - INFO - Batch 20/33 - Loss: 0.7611
2025-04-15 14:16:18,047 - INFO - GPU Memory: 324.05MB allocated, 1950.00MB cached
2025-04-15 14:16:23,218 - INFO - Current learning rate: 0.0000030
2025-04-15 14:16:28,286 - INFO - Epoch 14 results:
2025-04-15 14:16:28,286 - INFO - Train Loss: 2.4168, Train Acc: 0.7917
2025-04-15 14:16:28,287 - INFO - Val Loss: 0.6824, Val Acc: 0.7612, Top-3 Acc: 0.9254
2025-04-15 14:16:28,287 - INFO - Epoch time: 18.32s
2025-04-15 14:16:28,287 - INFO - Validation accuracy did not improve. Early stopping counter: 2/5
2025-04-15 14:16:28,395 - INFO - Saved latest model for epoch 14
2025-04-15 14:16:28,395 - INFO - Epoch 15/15
2025-04-15 14:16:36,495 - INFO - Batch 20/33 - Loss: 0.0000
2025-04-15 14:16:36,496 - INFO - GPU Memory: 324.05MB allocated, 1950.00MB cached
2025-04-15 14:16:41,679 - INFO - Current learning rate: 0.0000500
2025-04-15 14:16:46,766 - INFO - Epoch 15 results:
2025-04-15 14:16:46,767 - INFO - Train Loss: 2.6588, Train Acc: 0.7197
2025-04-15 14:16:46,767 - INFO - Val Loss: 0.5078, Val Acc: 0.7612, Top-3 Acc: 0.9403
2025-04-15 14:16:46,767 - INFO - Epoch time: 18.37s
2025-04-15 14:16:46,767 - INFO - Validation accuracy did not improve. Early stopping counter: 3/5
2025-04-15 14:16:46,874 - INFO - Saved latest model for epoch 15
2025-04-15 14:16:47,111 - INFO - Saved training curves to evaluation_results/training_curves_epoch15.png
2025-04-15 14:16:47,111 - INFO - Training completed in 256.41s
2025-04-15 14:16:47,111 - INFO - Best validation accuracy: 0.8209
2025-04-15 14:16:47,295 - INFO - Saved final model to models/celebrity_recognition_model.pth
2025-04-15 14:16:47,295 - INFO - Saved vocabulary for future predictions
2025-04-15 14:16:47,296 - INFO - Training completed successfully
2025-04-15 14:16:47,296 - INFO - Created prediction script: predict.py
2025-04-15 14:19:15,436 - INFO - Creating PyTorch model with resnet50 architecture
2025-04-15 14:19:15,920 - INFO - Model created and moved to cuda
2025-04-15 14:19:15,920 - INFO - Added dropout and normalization layers for better regularization
2025-04-15 14:19:15,920 - INFO - Loading model from models/celebrity_recognition_model.pth
2025-04-15 14:19:16,006 - INFO - Error loading model: Error(s) in loading state_dict for ResNet:
	size mismatch for fc.6.weight: copying a param with shape torch.Size([10, 512]) from checkpoint, the shape in current model is torch.Size([30, 512]).
	size mismatch for fc.6.bias: copying a param with shape torch.Size([10]) from checkpoint, the shape in current model is torch.Size([30]).
